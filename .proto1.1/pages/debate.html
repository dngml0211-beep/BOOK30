<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶í´ëŸ½ 3.0 - ë…ì„œí† ë¡ </title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            bg: '#FEF3C7', primary: '#FF9F43', dark: '#F368E0', secondary: '#54a0ff', green: '#1dd1a1'
                        },
                        debate: {
                            blue: '#3B82F6',
                            blueDark: '#1D4ED8',
                            red: '#EF4444',
                            redDark: '#DC2626',
                            purple: '#8B5CF6'
                        }
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .font-noto { font-family: 'Noto Sans KR', sans-serif; }

        body {
            background: linear-gradient(180deg, #EEF2FF 0%, #E0E7FF 50%, #C7D2FE 100%);
        }

        /* 3D ë²„íŠ¼ */
        .btn-3d {
            transform: translateY(-4px);
            transition: all 0.1s ease;
        }
        .btn-3d:active {
            transform: translateY(0);
        }

        /* íˆ¬í‘œ ë²„íŠ¼ */
        .vote-btn {
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        .vote-btn:hover {
            transform: translateY(-4px) scale(1.02);
        }
        .vote-btn:active {
            transform: translateY(0) scale(0.98);
        }
        .vote-btn.selected {
            transform: scale(1.05);
        }
        .vote-btn.not-selected {
            opacity: 0.4;
            filter: grayscale(0.5);
            transform: scale(0.95);
        }

        /* í„ìŠ¤ íš¨ê³¼ */
        .pulse-ring {
            animation: pulseRing 2s ease-in-out infinite;
        }
        @keyframes pulseRing {
            0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            50% { box-shadow: 0 0 0 15px rgba(59, 130, 246, 0); }
        }

        /* ìŠ¬ë¼ì´ë“œ ì• ë‹ˆë©”ì´ì…˜ */
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ë‘êµ¬ë‘êµ¬ ê²°ê³¼ ê³µê°œ */
        .reveal-animation {
            animation: reveal 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes reveal {
            0% { transform: scale(0) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        /* ë“œëŸ¼ë¡¤ íš¨ê³¼ */
        .drumroll {
            animation: drumroll 0.1s ease-in-out infinite alternate;
        }
        @keyframes drumroll {
            from { transform: translateX(-2px); }
            to { transform: translateX(2px); }
        }

        /* ë…¹ìŒ ë²„íŠ¼ */
        .record-btn.recording {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            animation: recordPulse 1s ease-in-out infinite;
        }
        @keyframes recordPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 12px rgba(239, 68, 68, 0); }
        }

        /* ì§„í–‰ ìŠ¤í… */
        .step-indicator {
            transition: all 0.3s ease;
        }
        .step-indicator.active {
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            color: white;
        }
        .step-indicator.completed {
            background: #10B981;
            color: white;
        }

        /* íƒ€ì´í•‘ íš¨ê³¼ */
        .typing-dots span {
            animation: typingDot 1.4s ease-in-out infinite;
        }
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typingDot {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-8px); }
        }

        /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
        .progress-bar-fill {
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="font-sans text-gray-800 min-h-screen overflow-x-hidden">
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-lg border-b border-indigo-100 px-6 py-4">
        <div class="max-w-2xl mx-auto flex items-center justify-between">
            <button onclick="goBack()" class="w-10 h-10 bg-indigo-50 hover:bg-indigo-100 rounded-xl flex items-center justify-center text-indigo-600 transition-colors">
                <i class="fa-solid fa-arrow-left"></i>
            </button>

            <!-- ì§„í–‰ ë‹¨ê³„ í‘œì‹œ -->
            <div class="flex items-center gap-2">
                <div id="step-1" class="step-indicator active w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">1</div>
                <div class="w-6 h-1 bg-gray-200 rounded-full"><div id="progress-1" class="h-full bg-indigo-500 rounded-full transition-all" style="width:0%"></div></div>
                <div id="step-2" class="step-indicator w-8 h-8 rounded-full bg-gray-200 text-gray-400 flex items-center justify-center text-sm font-bold">2</div>
                <div class="w-6 h-1 bg-gray-200 rounded-full"><div id="progress-2" class="h-full bg-indigo-500 rounded-full transition-all" style="width:0%"></div></div>
                <div id="step-3" class="step-indicator w-8 h-8 rounded-full bg-gray-200 text-gray-400 flex items-center justify-center text-sm font-bold">3</div>
                <div class="w-6 h-1 bg-gray-200 rounded-full"><div id="progress-3" class="h-full bg-indigo-500 rounded-full transition-all" style="width:0%"></div></div>
                <div id="step-4" class="step-indicator w-8 h-8 rounded-full bg-gray-200 text-gray-400 flex items-center justify-center text-sm font-bold">4</div>
            </div>

            <div class="w-10"></div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
    <main class="max-w-2xl mx-auto px-6 py-8" id="main-content">
        <!-- Stage 1: ì£¼ì œ ì œì‹œ ë° íˆ¬í‘œ -->
        <div id="stage-1" class="slide-in">
            <!-- ìºë¦­í„° -->
            <div class="text-center mb-6">
                <div class="inline-block relative">
                    <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center text-4xl shadow-lg border-4 border-indigo-200 float-animation">
                        ğŸ¿ï¸
                    </div>
                    <div class="absolute -bottom-2 -right-2 bg-indigo-500 text-white text-xs px-2 py-1 rounded-full font-bold">
                        í† ë¡ ì™•
                    </div>
                </div>
                <div class="mt-3 bg-white rounded-2xl px-5 py-3 shadow-md inline-block">
                    <p class="font-noto text-indigo-600">ì˜¤ëŠ˜ì˜ í† ë¡  ì£¼ì œì˜ˆìš”! ì°¬ì„±? ë°˜ëŒ€?</p>
                </div>
            </div>

            <!-- í† ë¡  ì£¼ì œ ì¹´ë“œ -->
            <div class="bg-white rounded-3xl p-6 shadow-xl border-2 border-indigo-100 mb-8">
                <!-- ì±… ì •ë³´ -->
                <div class="flex items-center gap-3 mb-4 pb-4 border-b border-gray-100">
                    <div class="w-12 h-16 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-lg flex items-center justify-center text-white text-xl shadow-md">
                        ğŸ“–
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">ì˜¤ëŠ˜ ì½ì€ ì±…</p>
                        <p class="font-noto text-gray-800">ë§ˆë²•ì‚¬ì˜ ë¬¼ì•½</p>
                    </div>
                </div>

                <!-- í† ë¡  ì£¼ì œ -->
                <div class="text-center mb-6">
                    <p class="text-sm text-indigo-500 font-bold mb-2">ğŸ’¬ í† ë¡  ì£¼ì œ</p>
                    <h2 class="font-noto text-2xl text-gray-800 leading-relaxed">
                        "ë§ˆë²•ì‚¬ê°€ ìˆ²ì† ì¹œêµ¬ë“¤ì—ê²Œ<br>
                        ë¬¼ì•½ì„ <span class="text-debate-blue">ë‚˜ëˆ ì¤˜ì•¼</span> í• ê¹Œ,<br>
                        <span class="text-debate-red">í˜¼ì ê°„ì§í•´ì•¼</span> í• ê¹Œ?"
                    </h2>
                </div>

                <!-- íˆ¬í‘œ ë²„íŠ¼ë“¤ -->
                <div class="grid grid-cols-2 gap-4">
                    <button id="vote-agree" onclick="selectVote('agree')" class="vote-btn bg-gradient-to-br from-blue-50 to-indigo-50 border-4 border-blue-200 rounded-2xl p-5 text-center pulse-ring">
                        <span class="text-5xl mb-3 block">ğŸ˜Š</span>
                        <span class="font-noto text-lg text-debate-blue block mb-1">ë‚˜ëˆ ì¤˜ì•¼ í•´!</span>
                        <span class="text-xs text-gray-500">í•¨ê»˜ ë‚˜ëˆ„ë©´ ë” ì¢‹ì•„ìš”</span>
                    </button>

                    <button id="vote-disagree" onclick="selectVote('disagree')" class="vote-btn bg-gradient-to-br from-red-50 to-pink-50 border-4 border-red-200 rounded-2xl p-5 text-center pulse-ring" style="animation-delay: 0.5s;">
                        <span class="text-5xl mb-3 block">ğŸ¤”</span>
                        <span class="font-noto text-lg text-debate-red block mb-1">ê°„ì§í•´ì•¼ í•´!</span>
                        <span class="text-xs text-gray-500">íŠ¹ë³„í•œ ê±´ ì†Œì¤‘í•˜ë‹ˆê¹Œ</span>
                    </button>
                </div>
            </div>

            <!-- ë‹¤ìŒ ë²„íŠ¼ -->
            <button id="btn-next-1" onclick="goToStage2()" disabled class="btn-3d w-full py-4 bg-gray-300 text-white rounded-2xl font-noto text-lg disabled:transform-none disabled:shadow-none" style="box-shadow: 0 6px 0 #9CA3AF;">
                ë¨¼ì € íˆ¬í‘œí•´ì£¼ì„¸ìš”
            </button>
        </div>

        <!-- Stage 2: ì˜ê²¬ ì‘ì„± -->
        <div id="stage-2" class="hidden slide-in">
            <div class="text-center mb-6">
                <div class="inline-block w-16 h-16 bg-white rounded-full flex items-center justify-center text-3xl shadow-lg border-4 border-indigo-200">
                    âœï¸
                </div>
                <p class="mt-3 font-noto text-lg text-gray-700">ì™œ ê·¸ë ‡ê²Œ ìƒê°í•˜ë‚˜ìš”?</p>
            </div>

            <!-- ì„ íƒí•œ ì…ì¥ í‘œì‹œ -->
            <div id="selected-stance" class="bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-2xl p-4 mb-6 text-center">
                <span class="text-2xl mr-2">ğŸ˜Š</span>
                <span class="font-noto text-lg">ë‚˜ëŠ” "ë‚˜ëˆ ì¤˜ì•¼ í•´!" ë¥¼ ì„ íƒí–ˆì–´ìš”</span>
            </div>

            <!-- ì˜ê²¬ ì…ë ¥ -->
            <div class="bg-white rounded-3xl p-6 shadow-xl border-2 border-indigo-100 mb-6">
                <p class="text-sm text-gray-500 mb-3">ë‚´ ìƒê°ì„ ì ì–´ì£¼ì„¸ìš”</p>
                <textarea id="opinion-text" placeholder="ì˜ˆ) ì¹œêµ¬ë“¤ì´ë‘ ê°™ì´ ì“°ë©´ ë” ì¬ë¯¸ìˆì„ ê²ƒ ê°™ì•„ìš”!" class="w-full h-32 bg-indigo-50 rounded-2xl p-4 text-gray-800 outline-none focus:ring-2 focus:ring-indigo-300 resize-none border border-indigo-100" oninput="checkOpinion()"></textarea>

                <!-- ë˜ëŠ” ìŒì„± ë…¹ìŒ -->
                <div class="flex items-center justify-center gap-4 mt-4 pt-4 border-t border-gray-100">
                    <span class="text-sm text-gray-400">ë˜ëŠ”</span>
                    <button id="record-btn" onclick="toggleRecording()" class="record-btn flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-red-400 to-pink-500 text-white rounded-full font-bold hover:shadow-lg transition-all">
                        <i class="fa-solid fa-microphone"></i>
                        <span id="record-text">ìŒì„±ìœ¼ë¡œ ë§í•˜ê¸°</span>
                    </button>
                </div>

                <!-- ë…¹ìŒ ì‹œê°„ í‘œì‹œ -->
                <div id="record-indicator" class="hidden mt-4 text-center">
                    <div class="inline-flex items-center gap-2 bg-red-100 text-red-600 px-4 py-2 rounded-full">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <span id="record-time">00:00</span>
                    </div>
                </div>
            </div>

            <!-- ë‹¤ìŒ ë²„íŠ¼ -->
            <button id="btn-next-2" onclick="goToStage3()" disabled class="btn-3d w-full py-4 bg-gray-300 text-white rounded-2xl font-noto text-lg disabled:transform-none disabled:shadow-none">
                ì˜ê²¬ì„ ì‘ì„±í•´ì£¼ì„¸ìš”
            </button>
        </div>

        <!-- Stage 3: íˆ¬í‘œ ê²°ê³¼ ê³µê°œ -->
        <div id="stage-3" class="hidden slide-in">
            <div class="text-center mb-8">
                <div class="inline-block w-20 h-20 bg-white rounded-full flex items-center justify-center text-4xl shadow-lg border-4 border-yellow-200 mb-4">
                    ğŸ¥
                </div>
                <p class="font-noto text-2xl text-gray-800">ë‘êµ¬ë‘êµ¬...</p>
                <p class="text-gray-500">íˆ¬í‘œ ê²°ê³¼ë¥¼ ê³µê°œí•©ë‹ˆë‹¤!</p>
            </div>

            <!-- ê²°ê³¼ ì¹´ë“œ (ì²˜ìŒì—” ìˆ¨ê¹€) -->
            <div id="result-card" class="opacity-0 bg-white rounded-3xl p-8 shadow-xl border-2 border-yellow-200 text-center">
                <!-- ë“œëŸ¼ë¡¤ ë¡œë”© -->
                <div id="drumroll-loader" class="py-12">
                    <div class="text-6xl drumroll mb-4">ğŸ²</div>
                    <p class="text-gray-500">ê²°ê³¼ ì§‘ê³„ ì¤‘...</p>
                </div>

                <!-- ì‹¤ì œ ê²°ê³¼ (ìˆ¨ê¹€) -->
                <div id="actual-result" class="hidden">
                    <p class="text-sm text-gray-500 mb-4">ìš°ë¦¬ ë°˜ ì¹œêµ¬ë“¤ì˜ ì„ íƒ</p>

                    <!-- ê·¸ë˜í”„ -->
                    <div class="flex items-center gap-2 mb-6">
                        <div class="text-3xl">ğŸ˜Š</div>
                        <div class="flex-1 h-10 bg-gray-100 rounded-full overflow-hidden flex">
                            <div id="result-bar-agree" class="progress-bar-fill h-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-end pr-3" style="width:0%">
                                <span class="text-white font-bold text-sm" id="result-percent-agree">0%</span>
                            </div>
                            <div id="result-bar-disagree" class="progress-bar-fill h-full bg-gradient-to-r from-red-400 to-pink-500 flex items-center justify-start pl-3" style="width:0%">
                                <span class="text-white font-bold text-sm" id="result-percent-disagree">0%</span>
                            </div>
                        </div>
                        <div class="text-3xl">ğŸ¤”</div>
                    </div>

                    <!-- ìƒì„¸ ìˆ˜ì¹˜ -->
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-blue-50 rounded-2xl p-4">
                            <p class="font-noto text-3xl text-debate-blue" id="count-agree">0ëª…</p>
                            <p class="text-sm text-gray-500">ë‚˜ëˆ ì¤˜ì•¼ í•´!</p>
                        </div>
                        <div class="bg-red-50 rounded-2xl p-4">
                            <p class="font-noto text-3xl text-debate-red" id="count-disagree">0ëª…</p>
                            <p class="text-sm text-gray-500">ê°„ì§í•´ì•¼ í•´!</p>
                        </div>
                    </div>

                    <!-- ë‚´ ì„ íƒ í‘œì‹œ -->
                    <div id="my-result" class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl p-4">
                        <span class="text-2xl mr-2">ğŸ¯</span>
                        <span class="font-noto">ë‚˜ëŠ” ë‹¤ìˆ˜ì™€ ê°™ì€ ìƒê°ì´ì—ìš”!</span>
                    </div>
                </div>
            </div>

            <!-- ë‹¤ìŒ ë²„íŠ¼ -->
            <button id="btn-next-3" onclick="goToStage4()" class="hidden btn-3d w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl font-noto text-lg mt-6" style="box-shadow: 0 6px 0 #4338CA;">
                ë‹¤ë¥¸ ì¹œêµ¬ë“¤ ì˜ê²¬ ë³´ê¸° <i class="fa-solid fa-arrow-right ml-2"></i>
            </button>
        </div>

        <!-- Stage 4: AI ì˜ê²¬ ìš”ì•½ -->
        <div id="stage-4" class="hidden slide-in">
            <div class="text-center mb-6">
                <div class="inline-block w-20 h-20 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full flex items-center justify-center text-4xl shadow-lg">
                    ğŸ¤–
                </div>
                <p class="mt-3 font-noto text-lg text-gray-700">AIê°€ ë‹¤ë¥¸ ì˜ê²¬ì„ ì •ë¦¬í–ˆì–´ìš”!</p>
            </div>

            <!-- AI ìš”ì•½ ì¹´ë“œ -->
            <div class="bg-white rounded-3xl p-6 shadow-xl border-2 border-purple-100 mb-6">
                <div class="flex items-center gap-3 mb-4 pb-4 border-b border-gray-100">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-500 rounded-xl flex items-center justify-center text-white text-xl shadow-md">
                        ğŸ¤–
                    </div>
                    <div>
                        <p class="font-noto text-gray-800">AI ë…ì„œ ë²„ë””</p>
                        <p class="text-xs text-gray-500">ë‹¤ë¥¸ ì¹œêµ¬ë“¤ì˜ ì˜ê²¬ì„ ìš”ì•½í–ˆì–´ìš”</p>
                    </div>
                </div>

                <!-- íƒ€ì´í•‘ íš¨ê³¼ -->
                <div id="ai-typing" class="text-center py-8">
                    <div class="typing-dots inline-flex gap-2">
                        <span class="w-3 h-3 bg-purple-400 rounded-full"></span>
                        <span class="w-3 h-3 bg-purple-400 rounded-full"></span>
                        <span class="w-3 h-3 bg-purple-400 rounded-full"></span>
                    </div>
                    <p class="text-gray-500 mt-2">ì˜ê²¬ì„ ì •ë¦¬í•˜ê³  ìˆì–´ìš”...</p>
                </div>

                <!-- AI ìš”ì•½ ë‚´ìš© -->
                <div id="ai-summary" class="hidden">
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 rounded-2xl p-5 mb-4">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="text-2xl">ğŸ¤”</span>
                            <span class="font-noto text-debate-red">"ê°„ì§í•´ì•¼ í•´!" ì¹œêµ¬ë“¤ì˜ ìƒê°</span>
                        </div>
                        <p class="text-gray-700 leading-relaxed" id="opposite-summary">
                            "íŠ¹ë³„í•œ ë¬¼ì•½ì€ ì•„ë¬´ì—ê²Œë‚˜ ì£¼ë©´ ìœ„í—˜í•  ìˆ˜ ìˆì–´ìš”. ë§ˆë²•ì‚¬ê°€ ì±…ì„ê° ìˆê²Œ ê´€ë¦¬í•´ì•¼ í•œë‹¤ê³  ìƒê°í•´ìš”. ë˜ í˜ë“¤ê²Œ ë§Œë“  ë¬¼ì•½ì´ë‹ˆê¹Œ ì†Œì¤‘íˆ ë³´ê´€í•˜ëŠ” ê²Œ ë§ì•„ìš”."
                        </p>
                    </div>

                    <div class="bg-purple-50 rounded-2xl p-4 text-center">
                        <p class="text-purple-600 text-sm">
                            <i class="fa-solid fa-lightbulb mr-1"></i>
                            ë‹¤ë¥¸ ìƒê°ë„ ì´í•´í•˜ë©´ ë” ë„“ì€ ì‹œì•¼ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš”!
                        </p>
                    </div>
                </div>
            </div>

            <!-- ì™„ë£Œ ë²„íŠ¼ -->
            <button id="btn-complete" onclick="completeDebate()" class="hidden btn-3d w-full py-4 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-2xl font-noto text-lg" style="box-shadow: 0 6px 0 #047857;">
                <i class="fa-solid fa-check mr-2"></i> í† ë¡  ì™„ë£Œ!
            </button>
        </div>
    </main>

    <!-- ì™„ë£Œ ëª¨ë‹¬ -->
    <div id="complete-modal" class="hidden fixed inset-0 z-[100] bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center">
        <div class="text-center px-6">
            <div class="reveal-animation w-40 h-40 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-2xl">
                <span class="text-7xl">ğŸ†</span>
            </div>
            <h2 class="font-noto text-4xl text-white mb-2">í† ë¡  ì™„ë£Œ!</h2>
            <p class="text-white/90 text-xl mb-8">ë©‹ì§„ ìƒê°ì„ ë‚˜ëˆ ì¤¬ì–´ìš”!</p>

            <div class="flex justify-center gap-4 mb-8">
                <div class="bg-white/20 backdrop-blur-sm rounded-2xl px-6 py-4 border border-white/30">
                    <span class="text-3xl mb-1 block">â­</span>
                    <span class="text-white font-noto">+30 ë³„</span>
                </div>
                <div class="bg-white/20 backdrop-blur-sm rounded-2xl px-6 py-4 border border-white/30">
                    <span class="text-3xl mb-1 block">ğŸ–ï¸</span>
                    <span class="text-white font-noto">í† ë¡  ë±ƒì§€</span>
                </div>
            </div>

            <button onclick="goBack()" class="btn-3d px-10 py-4 bg-white text-indigo-600 rounded-2xl font-noto text-lg" style="box-shadow: 0 6px 0 #C7D2FE;">
                ëŒì•„ê°€ê¸°
            </button>
        </div>
    </div>

    <script src="../js/common.js"></script>
    <script>
        // ìƒíƒœ ê´€ë¦¬
        let userVote = null; // 'agree' or 'disagree'
        let userOpinion = '';
        let isRecording = false;
        let recordingInterval = null;
        let recordingSeconds = 0;

        // Stage 1: íˆ¬í‘œ ì„ íƒ
        function selectVote(vote) {
            userVote = vote;

            const agreeBtn = document.getElementById('vote-agree');
            const disagreeBtn = document.getElementById('vote-disagree');

            // ì„ íƒ ìƒíƒœ í‘œì‹œ
            agreeBtn.classList.remove('selected', 'not-selected', 'pulse-ring');
            disagreeBtn.classList.remove('selected', 'not-selected', 'pulse-ring');

            if (vote === 'agree') {
                agreeBtn.classList.add('selected');
                agreeBtn.style.borderColor = '#3B82F6';
                disagreeBtn.classList.add('not-selected');
            } else {
                disagreeBtn.classList.add('selected');
                disagreeBtn.style.borderColor = '#EF4444';
                agreeBtn.classList.add('not-selected');
            }

            // ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
            const btn = document.getElementById('btn-next-1');
            btn.disabled = false;
            btn.className = 'btn-3d w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl font-noto text-lg';
            btn.style.boxShadow = '0 6px 0 #4338CA';
            btn.textContent = 'ë‚´ ì˜ê²¬ ë§í•˜ê¸° â†’';
        }

        // Stage 2ë¡œ ì´ë™
        function goToStage2() {
            document.getElementById('stage-1').classList.add('hidden');
            document.getElementById('stage-2').classList.remove('hidden');

            // ì§„í–‰ í‘œì‹œ ì—…ë°ì´íŠ¸
            document.getElementById('step-1').classList.remove('active');
            document.getElementById('step-1').classList.add('completed');
            document.getElementById('progress-1').style.width = '100%';
            document.getElementById('step-2').classList.add('active');

            // ì„ íƒí•œ ì…ì¥ í‘œì‹œ
            const stanceDiv = document.getElementById('selected-stance');
            if (userVote === 'agree') {
                stanceDiv.className = 'bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-2xl p-4 mb-6 text-center';
                stanceDiv.innerHTML = '<span class="text-2xl mr-2">ğŸ˜Š</span><span class="font-noto text-lg">ë‚˜ëŠ” "ë‚˜ëˆ ì¤˜ì•¼ í•´!" ë¥¼ ì„ íƒí–ˆì–´ìš”</span>';
            } else {
                stanceDiv.className = 'bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-2xl p-4 mb-6 text-center';
                stanceDiv.innerHTML = '<span class="text-2xl mr-2">ğŸ¤”</span><span class="font-noto text-lg">ë‚˜ëŠ” "ê°„ì§í•´ì•¼ í•´!" ë¥¼ ì„ íƒí–ˆì–´ìš”</span>';
            }
        }

        // ì˜ê²¬ ì…ë ¥ ì²´í¬
        function checkOpinion() {
            const text = document.getElementById('opinion-text').value.trim();
            const btn = document.getElementById('btn-next-2');

            if (text.length >= 5) {
                userOpinion = text;
                btn.disabled = false;
                btn.className = 'btn-3d w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl font-noto text-lg';
                btn.style.boxShadow = '0 6px 0 #4338CA';
                btn.textContent = 'íˆ¬í‘œ ê²°ê³¼ ë³´ê¸° â†’';
            } else {
                btn.disabled = true;
                btn.className = 'btn-3d w-full py-4 bg-gray-300 text-white rounded-2xl font-noto text-lg disabled:transform-none disabled:shadow-none';
                btn.textContent = 'ì˜ê²¬ì„ ì‘ì„±í•´ì£¼ì„¸ìš”';
            }
        }

        // ë…¹ìŒ í† ê¸€
        function toggleRecording() {
            const btn = document.getElementById('record-btn');
            const text = document.getElementById('record-text');
            const indicator = document.getElementById('record-indicator');
            const timeDisplay = document.getElementById('record-time');

            isRecording = !isRecording;

            if (isRecording) {
                btn.classList.add('recording');
                text.textContent = 'ë…¹ìŒ ì¤‘ì§€';
                indicator.classList.remove('hidden');
                recordingSeconds = 0;

                recordingInterval = setInterval(() => {
                    recordingSeconds++;
                    const mins = Math.floor(recordingSeconds / 60).toString().padStart(2, '0');
                    const secs = (recordingSeconds % 60).toString().padStart(2, '0');
                    timeDisplay.textContent = `${mins}:${secs}`;
                }, 1000);
            } else {
                btn.classList.remove('recording');
                text.textContent = 'ìŒì„±ìœ¼ë¡œ ë§í•˜ê¸°';
                indicator.classList.add('hidden');
                clearInterval(recordingInterval);

                if (recordingSeconds > 2) {
                    userOpinion = '[ìŒì„± ë…¹ìŒë¨]';
                    const btn2 = document.getElementById('btn-next-2');
                    btn2.disabled = false;
                    btn2.className = 'btn-3d w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl font-noto text-lg';
                    btn2.style.boxShadow = '0 6px 0 #4338CA';
                    btn2.textContent = 'íˆ¬í‘œ ê²°ê³¼ ë³´ê¸° â†’';
                }
            }
        }

        // Stage 3ë¡œ ì´ë™
        function goToStage3() {
            document.getElementById('stage-2').classList.add('hidden');
            document.getElementById('stage-3').classList.remove('hidden');

            // ì§„í–‰ í‘œì‹œ ì—…ë°ì´íŠ¸
            document.getElementById('step-2').classList.remove('active');
            document.getElementById('step-2').classList.add('completed');
            document.getElementById('progress-2').style.width = '100%';
            document.getElementById('step-3').classList.add('active');

            // ê²°ê³¼ ì¹´ë“œ í‘œì‹œ
            setTimeout(() => {
                document.getElementById('result-card').style.opacity = '1';
            }, 300);

            // ë“œëŸ¼ë¡¤ í›„ ê²°ê³¼ ê³µê°œ
            setTimeout(() => {
                document.getElementById('drumroll-loader').classList.add('hidden');
                document.getElementById('actual-result').classList.remove('hidden');

                // ê²°ê³¼ ì• ë‹ˆë©”ì´ì…˜
                setTimeout(() => {
                    // ê°€ìƒì˜ íˆ¬í‘œ ê²°ê³¼ (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ë°›ì•„ì˜´)
                    const agreePercent = 62;
                    const disagreePercent = 38;

                    document.getElementById('result-bar-agree').style.width = agreePercent + '%';
                    document.getElementById('result-bar-disagree').style.width = disagreePercent + '%';
                    document.getElementById('result-percent-agree').textContent = agreePercent + '%';
                    document.getElementById('result-percent-disagree').textContent = disagreePercent + '%';
                    document.getElementById('count-agree').textContent = '15ëª…';
                    document.getElementById('count-disagree').textContent = '9ëª…';

                    // ë‚´ ì„ íƒ ê²°ê³¼
                    const myResult = document.getElementById('my-result');
                    if ((userVote === 'agree' && agreePercent > 50) || (userVote === 'disagree' && disagreePercent > 50)) {
                        myResult.innerHTML = '<span class="text-2xl mr-2">ğŸ¯</span><span class="font-noto">ë‚˜ëŠ” ë‹¤ìˆ˜ì™€ ê°™ì€ ìƒê°ì´ì—ìš”!</span>';
                    } else {
                        myResult.className = 'bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl p-4';
                        myResult.innerHTML = '<span class="text-2xl mr-2">ğŸ’¡</span><span class="font-noto">ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ìƒê°ì´ì—ìš”!</span>';
                    }

                    // ë‹¤ìŒ ë²„íŠ¼ í‘œì‹œ
                    document.getElementById('btn-next-3').classList.remove('hidden');
                }, 500);
            }, 2500);
        }

        // Stage 4ë¡œ ì´ë™
        function goToStage4() {
            document.getElementById('stage-3').classList.add('hidden');
            document.getElementById('stage-4').classList.remove('hidden');

            // ì§„í–‰ í‘œì‹œ ì—…ë°ì´íŠ¸
            document.getElementById('step-3').classList.remove('active');
            document.getElementById('step-3').classList.add('completed');
            document.getElementById('progress-3').style.width = '100%';
            document.getElementById('step-4').classList.add('active');

            // AI ìš”ì•½ í‘œì‹œ
            setTimeout(() => {
                document.getElementById('ai-typing').classList.add('hidden');
                document.getElementById('ai-summary').classList.remove('hidden');

                // ë°˜ëŒ€ ì˜ê²¬ ìš”ì•½ (ì‚¬ìš©ìê°€ ì°¬ì„±ì„ ì„ íƒí•œ ê²½ìš°)
                const summaryText = document.getElementById('opposite-summary');
                if (userVote === 'agree') {
                    summaryText.textContent = '"íŠ¹ë³„í•œ ë¬¼ì•½ì€ ì•„ë¬´ì—ê²Œë‚˜ ì£¼ë©´ ìœ„í—˜í•  ìˆ˜ ìˆì–´ìš”. ë§ˆë²•ì‚¬ê°€ ì±…ì„ê° ìˆê²Œ ê´€ë¦¬í•´ì•¼ í•œë‹¤ê³  ìƒê°í•´ìš”. ë˜ í˜ë“¤ê²Œ ë§Œë“  ë¬¼ì•½ì´ë‹ˆê¹Œ ì†Œì¤‘íˆ ë³´ê´€í•˜ëŠ” ê²Œ ë§ì•„ìš”."';
                } else {
                    document.querySelector('#ai-summary > div:first-child').className = 'bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-5 mb-4';
                    document.querySelector('#ai-summary > div:first-child > div').innerHTML = '<span class="text-2xl">ğŸ˜Š</span><span class="font-noto text-debate-blue">"ë‚˜ëˆ ì¤˜ì•¼ í•´!" ì¹œêµ¬ë“¤ì˜ ìƒê°</span>';
                    summaryText.textContent = '"ìˆ²ì† ì¹œêµ¬ë“¤ë„ ë¬¼ì•½ì´ í•„ìš”í•  ë•Œê°€ ìˆì„ ê±°ì˜ˆìš”. í•¨ê»˜ ë‚˜ëˆ„ë©´ ë” ë§ì€ ì¢‹ì€ ì¼ì´ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”. ë§ˆë²•ì‚¬ í˜¼ìë§Œ ì“°ê¸°ì—” ë„ˆë¬´ ì•„ê¹ë‹¤ê³  ìƒê°í•´ìš”."';
                }

                // ì™„ë£Œ ë²„íŠ¼ í‘œì‹œ
                setTimeout(() => {
                    document.getElementById('btn-complete').classList.remove('hidden');
                }, 500);
            }, 2000);
        }

        // í† ë¡  ì™„ë£Œ
        function completeDebate() {
            document.getElementById('complete-modal').classList.remove('hidden');
        }

        // ë’¤ë¡œê°€ê¸°
        function goBack() {
            // AI ë²„ë””ì—ì„œ ì˜¨ ê²½ìš° ë²„ë””ë¡œ ëŒì•„ê°€ê¸°
            const chatState = sessionStorage.getItem('aiBuddyChatState');
            if (chatState) {
                window.location.href = 'ai-buddy.html';
                return;
            }

            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'home.html';
            }
        }
    </script>

<!-- Proto Navigation (æ€¨ë“¯ë„» Dev Tool) -->
<link rel="stylesheet" href="../css/proto-nav.css">
<script src="../js/proto-nav.js"></script>
</body>
</html>
