<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>북클럽 3.0 - 마이페이지</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            bg: '#FEF3C7', primary: '#FF9F43', dark: '#F368E0', secondary: '#54a0ff', green: '#1dd1a1', paper: '#FDFBF7'
                        }
                    },
                    boxShadow: {
                        'soft': '0 10px 25px -5px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/responsive.css">

    <style>
        .font-noto { font-family: 'Noto Sans KR', sans-serif; }

        /* === 탭 메뉴 스타일 === */
        .mypage-tabs {
            display: flex;
            gap: 4px;
            background: #f3f4f6;
            padding: 4px;
            border-radius: 16px;
            margin-bottom: 24px;
        }
        .mypage-tab {
            flex: 1;
            padding: 12px 16px;
            border-radius: 12px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #6b7280;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .mypage-tab:hover {
            color: #374151;
            background: rgba(255,255,255,0.5);
        }
        .mypage-tab.active {
            background: white;
            color: #FF9F43;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        /* === 2열 그리드 === */
        .my-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: stretch;
        }
        .my-grid .my-card-full {
            grid-column: 1 / -1;
        }
        @media (max-width: 768px) {
            .my-grid {
                grid-template-columns: 1fr;
            }
        }

        /* === 카드 스타일 === */
        .my-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.04);
            border: 1px solid #f3f4f6;
        }
        .my-card-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* === 내 현황 2그룹 레이아웃 === */
        .my-status-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* 1. 상단 그룹: 프로필 + 별 + 스타샵 */
        .status-group-top {
            background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .stars-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .star-display {
            display: flex;
            align-items: center;
            gap: 12px;
            padding-right: 16px;
            border-right: 2px solid rgba(251, 146, 60, 0.2);
        }

        /* 2. 나의 독서 활동 그룹 */
        .status-group-activity {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 16px;
            padding: 20px;
        }

        .activity-header {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-info-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .activity-info-item {
            flex: 1;
            min-width: 200px;
            background: #F9FAFB;
            border-radius: 12px;
            padding: 12px 16px;
        }

        .activity-info-label {
            font-size: 12px;
            color: #6B7280;
            margin-bottom: 4px;
        }

        .activity-info-value {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
        }

        .activity-info-badge {
            display: inline-block;
            font-size: 11px;
            font-weight: 600;
            color: #F59E0B;
            background: #FEF3C7;
            padding: 2px 8px;
            border-radius: 8px;
            margin-left: 6px;
        }

        /* 활동 카드 그리드 (1x5) */
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            width: 100%;
        }

        /* === 활동 카드 슬라이더 === */
        .activity-slider {
            width: 100%;
            display: contents;
        }

        .activity-slider-track {
            display: contents;
        }

        .activity-slider-track .activity-card {
            min-width: 0;
        }

        /* 슬라이더 인디케이터 */
        .activity-slider-dots {
            display: none;
        }

        .activity-slider-dots .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #d1d5db;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .activity-slider-dots .dot:hover {
            background: #9ca3af;
            transform: scale(1.2);
        }

        .activity-slider-dots .dot.active {
            background: #fbbf24;
            width: 24px;
            border-radius: 4px;
        }

        /* === 활동 카드 === */
        .activity-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            min-height: 140px;
        }

        .activity-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        /* 1. 최근 출석일 (불꽃 테마) */
        .attendance-card {
            background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
            border-color: #fb923c;
        }

        .attendance-card .activity-card-icon {
            font-size: 36px;
            animation: fire 1.5s infinite;
        }

        @keyframes fire {
            0%, 100% { transform: scale(1) rotate(-5deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        .attendance-card .activity-card-badge {
            background: #fb923c;
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
        }

        /* 2. 나의 감상문 (책 테마) */
        .review-card {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-color: #3b82f6;
            flex-direction: column;
            align-items: center;
        }

        .review-card .activity-card-thumbnail {
            width: 80px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .review-card .activity-card-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .default-book-cover {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 50%, #93c5fd 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            border: 2px solid #3b82f6;
        }

        .default-review-cover {
            width: 100%;
            height: 100%;
            background: #FAFAFA;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
            color: #6B7280;
            border: 1.5px solid #E5E7EB;
            font-family: 'Noto Sans KR', sans-serif;
            letter-spacing: 0.5px;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
        }

        .review-card .activity-card-title {
            font-size: 12px;
            font-weight: 700;
            color: #1e40af;
            margin-top: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
            text-align: center;
        }

        /* 3. 획득한 단어 (단어장 테마) */
        .word-card {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: #10b981;
        }

        .word-card .activity-card-icon {
            font-size: 32px;
        }

        .word-card .activity-card-word {
            font-size: 14px;
            font-weight: 800;
            color: #065f46;
            margin-top: 4px;
            padding: 4px 10px;
            background: white;
            border-radius: 8px;
            border: 2px dashed #10b981;
        }

        .word-card .activity-card-badge {
            background: #10b981;
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            margin-top: 6px;
        }

        /* 4. 획득한 상장 (트로피 테마) */
        .award-card {
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
            border-color: #fbbf24;
        }

        .award-card .activity-card-icon {
            font-size: 36px;
            animation: trophy 2s infinite;
        }

        @keyframes trophy {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1) rotate(10deg); }
        }

        .award-card .activity-card-award {
            font-size: 13px;
            font-weight: 800;
            color: #92400e;
            margin-top: 4px;
            padding: 4px 12px;
            background: white;
            border-radius: 10px;
            border: 2px solid #fbbf24;
            box-shadow: 0 2px 8px rgba(251,191,36,0.2);
        }

        /* 5. 받은 뱃지 (뱃지 테마) */
        .badge-card {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-color: #9ca3af;
        }

        .badge-card .activity-card-icon {
            font-size: 36px;
            animation: badge-shine 3s infinite;
        }

        @keyframes badge-shine {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .badge-card .activity-card-badge-name {
            font-size: 13px;
            font-weight: 800;
            color: #374151;
            margin-top: 4px;
            padding: 4px 12px;
            background: white;
            border-radius: 10px;
            border: 2px solid #9ca3af;
            box-shadow: 0 2px 8px rgba(156,163,175,0.2);
        }

        /* 공통 스타일 */
        .activity-card-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100%;
        }

        .activity-card-label {
            font-size: 11px;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .activity-card-value {
            font-size: 14px;
            font-weight: 700;
            color: #1f2937;
        }

        .activity-card-date {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 4px;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .status-group-top {
                flex-direction: column;
                text-align: center;
            }

            .profile-section {
                flex-direction: column;
            }

            .stars-section {
                flex-direction: column;
            }

            .star-display {
                border-right: none;
                border-bottom: 2px solid rgba(251, 146, 60, 0.2);
                padding-right: 0;
                padding-bottom: 12px;
            }

            .activity-info-row {
                flex-direction: column;
            }

            .activity-info-item {
                min-width: 100%;
            }

            .activity-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .activity-grid {
                grid-template-columns: 1fr;
            }

            .activity-card {
                padding: 14px;
                min-height: 120px;
            }
        }

        /* === 프로필 섹션 === */
        .profile-photo {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF9F43, #F368E0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: pointer;
            position: relative;
            transition: transform 0.2s;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(255,159,67,0.3);
        }
        .profile-photo:hover {
            transform: scale(1.05);
        }
        .profile-photo-edit {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 28px;
            height: 28px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            color: #6b7280;
            font-size: 12px;
        }

        .level-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            color: #d97706;
        }

        .taste-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            color: #7c3aed;
        }

        .setting-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 500;
            color: #4b5563;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }
        .setting-btn:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
        }

        .star-count {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: linear-gradient(135deg, #fef9c3, #fef08a);
            border-radius: 12px;
            border: 1px solid #fde047;
        }
        .star-count-num {
            font-size: 20px;
            font-weight: 800;
            color: #ca8a04;
            font-family: 'Noto Sans KR', sans-serif;
        }
        .star-count-label {
            font-size: 11px;
            color: #a16207;
            font-weight: 500;
        }

        .starshop-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: linear-gradient(135deg, #FF9F43, #f59e0b);
            border-radius: 12px;
            color: white;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(255,159,67,0.3);
        }
        .starshop-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255,159,67,0.4);
        }

        /* === 출석 달력 === */
        .calendar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .calendar-month {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
        }
        .calendar-nav {
            display: flex;
            gap: 8px;
        }
        .calendar-nav button {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            background: white;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .calendar-nav button:hover {
            background: #f9fafb;
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 8px;
        }
        .calendar-weekday {
            text-align: center;
            font-size: 11px;
            font-weight: 600;
            color: #9ca3af;
            padding: 4px;
        }
        .calendar-weekday.sun { color: #ef4444; }
        .calendar-weekday.sat { color: #3b82f6; }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 500;
            color: #374151;
            position: relative;
            background: #fafafa;
            border: 1px solid #f3f4f6;
        }
        .calendar-day.empty {
            background: transparent;
            border: none;
        }
        .calendar-day.stamped {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            border-color: #fed7aa;
        }
        .calendar-day.stamped .stamp-icon {
            position: absolute;
            font-size: 18px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .calendar-day.stamped .day-num {
            opacity: 0.4;
            font-size: 10px;
        }
        .calendar-day.today {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            box-shadow: 0 0 0 3px rgba(245,158,11,0.15);
        }
        .calendar-day.future {
            background: #f9fafb;
            color: #d1d5db;
            border: 1px dashed #e5e7eb;
        }

        .attendance-stats {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #f3f4f6;
        }
        .attendance-stat {
            flex: 1;
            text-align: center;
            padding: 12px;
            background: #f9fafb;
            border-radius: 12px;
        }
        .attendance-stat-num {
            font-size: 20px;
            font-weight: 800;
            color: #f97316;
        }
        .attendance-stat-label {
            font-size: 11px;
            color: #6b7280;
            margin-top: 2px;
        }

        /* === 독서로 키재기 (가로형) === */
        .height-layout {
            display: flex;
            align-items: flex-end;
            gap: 24px;
        }
        .height-meter {
            position: relative;
            width: 280px;
            min-width: 280px;
            height: 336px;
            background: linear-gradient(180deg, #FFFBEB 0%, #FEF3C7 100%);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding: 16px;
            flex-shrink: 0;
        }
        .height-figure {
            position: relative;
            width: 224px;
            height: 252px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
        }
        .height-figure img {
            width: 210px;
            height: auto;
            object-fit: contain;
            position: relative;
            top: -20px;
            margin-right: 20px;
        }
        .height-progress-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 5px 12px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 700;
            box-shadow: 0 3px 10px rgba(245,158,11,0.3);
        }

        .height-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 14px;
            min-width: 0;
        }
        .height-target {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .height-target-label {
            font-size: 12px;
            color: #6b7280;
        }
        .height-target-name {
            font-size: 18px;
            font-weight: 800;
            color: #1f2937;
        }
        .height-progress-bar {
            width: 100%;
            height: 12px;
            background: #f3f4f6;
            border-radius: 8px;
            overflow: hidden;
        }
        .height-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 8px;
            transition: width 0.5s ease;
        }
        .height-stats {
            display: flex;
            gap: 12px;
        }
        .height-stat-item {
            flex: 1;
            padding: 12px 14px;
            background: #f9fafb;
            border-radius: 12px;
            border: 1px solid #f3f4f6;
        }
        .height-stat-num {
            font-size: 22px;
            font-weight: 800;
            color: #f59e0b;
        }
        .height-stat-label {
            font-size: 11px;
            color: #6b7280;
            margin-top: 2px;
        }
        .height-next {
            padding: 12px 16px;
            background: #f0f9ff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .height-next-icon {
            font-size: 24px;
        }
        .height-next-text {
            font-size: 12px;
            color: #0369a1;
        }
        .height-next-name {
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .height-layout {
                flex-direction: column;
                align-items: center;
            }
            .height-meter {
                width: 100%;
                min-width: unset;
                height: 308px;
            }
        }

        /* === Info 버튼 === */
        .height-info-btn {
            margin-left: auto;
            padding: 8px 16px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .height-info-btn:hover {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.4);
        }

        .height-info-btn i {
            font-size: 14px;
        }

        /* === 마일스톤 모달 === */
        .milestone-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .milestone-modal.show {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .milestone-modal-content {
            position: relative;
            background: white;
            border-radius: 28px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* 닫기 버튼 */
        .milestone-close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f3f4f6;
            color: #6b7280;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .milestone-close-btn:hover {
            background: #e5e7eb;
            color: #1f2937;
            transform: rotate(90deg);
        }

        /* 타이틀 */
        .milestone-title {
            font-size: 24px;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 8px;
            text-align: center;
        }

        .milestone-subtitle {
            font-size: 14px;
            color: #6b7280;
            text-align: center;
            margin-bottom: 32px;
        }

        /* 캐러셀 */
        .milestone-carousel {
            position: relative;
            min-height: 420px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        /* 네비게이션 */
        .milestone-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .milestone-nav-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid #e5e7eb;
            background: white;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .milestone-nav-btn:hover:not(:disabled) {
            border-color: #fbbf24;
            background: #fffbeb;
            color: #f59e0b;
            transform: scale(1.1);
        }

        .milestone-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* 인디케이터 */
        .milestone-indicators {
            display: flex;
            gap: 8px;
            flex: 1;
            justify-content: center;
        }

        .milestone-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #d1d5db;
            cursor: pointer;
            transition: all 0.3s;
        }

        .milestone-dot:hover {
            background: #9ca3af;
        }

        .milestone-dot.active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            width: 28px;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
        }

        /* === 단계 카드 === */
        .milestone-stage {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 24px;
            border: 3px solid #e5e7eb;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .milestone-stage.active-stage {
            display: block;
            animation: stageSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes stageSlideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* 상태 배지 */
        .milestone-status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        /* === Stage Visual === */
        .milestone-stage-visual {
            position: relative;
            height: 200px;
            background: linear-gradient(180deg, #ffffff 0%, #fef9c3 100%);
            border-radius: 16px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            padding: 16px;
            border: 2px solid #fde68a;
            overflow: hidden;
        }

        .milestone-height-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, #fbbf24, #f59e0b);
            transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            opacity: 0.3;
            border-radius: 0 0 14px 14px;
        }

        .milestone-emoji {
            font-size: 80px;
            z-index: 2;
            animation: bounceIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 단계 정보 */
        .milestone-stage-info {
            text-align: center;
        }

        .milestone-stage-number {
            font-size: 14px;
            color: #f59e0b;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .milestone-stage-title {
            font-size: 22px;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 12px;
        }

        .milestone-stage-stats {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 12px;
        }

        .milestone-books,
        .milestone-height {
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 8px;
            background: #f3f4f6;
            color: #6b7280;
        }

        .milestone-stage-desc {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }

        /* === 상태별 스타일 === */
        /* 획득 완료 */
        .milestone-stage-completed {
            border-color: #22c55e;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }

        .milestone-stage-completed .milestone-status-badge {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .milestone-stage-completed .milestone-stage-visual {
            background: linear-gradient(180deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: #86efac;
        }

        /* 진행중 (현재 단계) */
        .milestone-stage-current {
            border-color: #fbbf24;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            box-shadow: 0 8px 24px rgba(251, 191, 36, 0.3);
        }

        .milestone-stage-current .milestone-status-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(251, 191, 36, 0);
            }
        }

        /* 잠김 */
        .milestone-stage-locked {
            border-color: #d1d5db;
            background: #f9fafb;
            opacity: 0.7;
        }

        .milestone-stage-locked .milestone-status-badge {
            background: #9ca3af;
            color: white;
        }

        .milestone-stage-locked .milestone-stage-visual {
            background: #f3f4f6;
            border-color: #d1d5db;
        }

        .milestone-stage-locked .milestone-emoji {
            filter: grayscale(1);
            opacity: 0.5;
        }

        /* === 모바일 반응형 === */
        @media (max-width: 640px) {
            .milestone-modal-content {
                padding: 24px;
                border-radius: 24px;
            }

            .milestone-title {
                font-size: 20px;
            }

            .milestone-stage {
                padding: 20px;
            }

            .milestone-stage-visual {
                height: 160px;
            }

            .milestone-emoji {
                font-size: 64px;
            }

            .milestone-stage-title {
                font-size: 18px;
            }

            .milestone-nav-btn {
                width: 40px;
                height: 40px;
            }

            .milestone-indicators {
                gap: 6px;
            }

            .milestone-dot {
                width: 8px;
                height: 8px;
            }

            .milestone-dot.active {
                width: 24px;
            }

            .height-info-btn span {
                display: none;
            }

            .height-info-btn {
                width: 32px;
                height: 32px;
                padding: 0;
                border-radius: 50%;
            }
        }

        /* === 리포트 탭 스타일 === */
        .report-toggle {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }
        .report-toggle-btn {
            flex: 1;
            padding: 14px 20px;
            border-radius: 14px;
            border: 2px solid #e5e7eb;
            background: white;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
        }
        .report-toggle-btn:hover {
            border-color: #FF9F43;
            color: #FF9F43;
        }
        .report-toggle-btn.active {
            border-color: #FF9F43;
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            color: #FF9F43;
        }
        .report-period {
            text-align: center;
            margin-bottom: 24px;
            padding: 14px;
            background: #f9fafb;
            border-radius: 12px;
            font-size: 14px;
            color: #6b7280;
        }
        .report-period strong {
            color: #1f2937;
        }
        .report-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .report-card-title {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .report-card-title i {
            font-size: 18px;
        }
        .report-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .report-stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
        .report-stat-item {
            background: #f9fafb;
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
        }
        .report-stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 12px;
        }
        .report-stat-value {
            font-size: 24px;
            font-weight: 800;
            color: #1f2937;
        }
        .report-stat-label {
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }
        .report-stat-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            margin-top: 8px;
        }
        .report-stat-change.up {
            background: #dcfce7;
            color: #16a34a;
        }
        .report-bar-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .report-bar-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .report-bar-label {
            width: 80px;
            font-size: 13px;
            color: #6b7280;
            flex-shrink: 0;
        }
        .report-bar-track {
            flex: 1;
            height: 28px;
            background: #f3f4f6;
            border-radius: 8px;
            overflow: hidden;
        }
        .report-bar-fill {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }
        .report-highlight-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .report-highlight-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: #fafafa;
            border-radius: 14px;
        }
        .report-highlight-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        .report-highlight-info {
            flex: 1;
        }
        .report-highlight-title {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }
        .report-highlight-desc {
            font-size: 12px;
            color: #6b7280;
            margin-top: 3px;
        }
        .report-highlight-badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            flex-shrink: 0;
        }
        .report-badge-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .report-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: #f9fafb;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        .report-badge-icon {
            font-size: 20px;
        }
        .report-badge-text {
            font-size: 13px;
            font-weight: 600;
            color: #1f2937;
        }
        /* 월간 리포트 - 독서력 & 레벨 */
        .report-power-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .report-power-grid { grid-template-columns: 1fr; }
        }
        .report-power-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .report-power-gauge {
            position: relative;
            width: 100px;
            height: 100px;
            flex-shrink: 0;
        }
        .report-power-gauge svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        .report-power-center {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .report-power-score {
            font-size: 28px;
            font-weight: 800;
            color: #f97316;
        }
        .report-power-unit {
            font-size: 11px;
            color: #9ca3af;
        }
        .report-power-info h4 {
            font-size: 15px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
        }
        .report-power-rank {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 5px 10px;
            background: #fef3c7;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 700;
            color: #d97706;
        }
        .report-power-info p {
            font-size: 12px;
            color: #6b7280;
            margin-top: 8px;
        }
        .report-level-card {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 20px;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            color: white;
        }
        .report-level-badge {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .report-level-num {
            font-size: 28px;
            font-weight: 800;
        }
        .report-level-label {
            font-size: 10px;
            text-transform: uppercase;
            opacity: 0.8;
        }
        .report-level-info {
            flex: 1;
        }
        .report-level-info h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            opacity: 0.95;
        }
        .report-level-bar {
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        .report-level-fill {
            height: 100%;
            background: white;
            border-radius: 4px;
        }
        .report-level-text {
            font-size: 12px;
            opacity: 0.85;
        }
        /* 능력 분석 */
        .report-ability-chart {
            display: flex;
            justify-content: center;
            padding: 10px 0;
        }
        .report-ability-chart svg {
            max-width: 260px;
            width: 100%;
        }
        .report-ability-summary {
            text-align: center;
            margin-top: 16px;
            padding: 14px;
            background: #f0fdf4;
            border-radius: 12px;
            font-size: 14px;
            color: #166534;
            font-weight: 500;
        }
        /* AI 코칭 */
        .report-ai-card {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
        }
        .report-ai-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        .report-ai-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF9F43, #fb923c);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }
        .report-ai-name {
            font-size: 14px;
            font-weight: 700;
            color: #9a3412;
        }
        .report-ai-message {
            font-size: 14px;
            color: #78350f;
            line-height: 1.7;
        }
        .report-ai-message b {
            color: #c2410c;
        }

        /* === KRS 레벨 리포트 전문 스타일 === */
        .krs-report-header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 24px;
            color: white;
        }

        .krs-report-period {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .period-label {
            font-size: 13px;
            opacity: 0.9;
            font-weight: 600;
        }

        .period-value {
            font-size: 16px;
            font-weight: 700;
        }

        .krs-report-level {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .level-badge {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 800;
        }

        .level-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
        }

        .level-status.completed {
            background: #22c55e;
            color: white;
        }

        /* 핵심 성과 카드 */
        .krs-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .krs-summary-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            display: flex;
            gap: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }

        .krs-summary-card:hover {
            transform: translateY(-4px);
        }

        .summary-icon {
            font-size: 48px;
            flex-shrink: 0;
        }

        .summary-content {
            flex: 1;
        }

        .summary-label {
            font-size: 13px;
            color: #6b7280;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .summary-value {
            font-size: 36px;
            font-weight: 900;
            color: #1f2937;
            line-height: 1;
            margin-bottom: 12px;
        }

        .summary-total {
            font-size: 20px;
            color: #9ca3af;
            font-weight: 600;
        }

        .summary-progress {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        .progress-fill.blue {
            background: linear-gradient(90deg, #3b82f6, #2563eb);
        }

        .progress-text {
            font-size: 12px;
            color: #6b7280;
            font-weight: 700;
        }

        .summary-meta {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .meta-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
        }

        .meta-badge.score-high {
            background: #dcfce7;
            color: #166534;
        }

        .meta-badge.score-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .meta-text {
            font-size: 12px;
            color: #6b7280;
        }

        /* KRS 추천도서 */
        .krs-recommended-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            color: #fbbf24;
        }

        .recommended-card {
            background: white;
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 32px;
        }

        .recommended-stats {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .stat-main {
            display: flex;
            flex-direction: column;
        }

        .stat-number {
            font-size: 48px;
            font-weight: 900;
            color: #fbbf24;
            line-height: 1;
        }

        .stat-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 600;
        }

        .stat-divider {
            width: 2px;
            height: 60px;
            background: #e5e7eb;
        }

        .stat-sub {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .stat-total {
            font-size: 13px;
            color: #6b7280;
        }

        .stat-percent {
            font-size: 24px;
            font-weight: 800;
            color: #1f2937;
        }

        .recommended-ranking {
            text-align: center;
        }

        .ranking-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .ranking-badge.top {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .ranking-text {
            font-size: 12px;
            color: #6b7280;
        }

        .recommended-progress-ring {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 차트 섹션 */
        .krs-chart-section {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .chart-container.small {
            height: 250px;
        }

        /* 활동별 완료율 차트 가운데 정렬 */
        .krs-chart-section:has(#activityCompletionChart) .chart-container {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            margin-bottom: 16px;
        }

        .krs-chart-section:has(#activityCompletionChart) .chart-container canvas {
            max-width: 100%;
        }

        /* 커스텀 범례 (2x2 그리드) */
        .custom-chart-legend {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px 20px;
            margin-top: 0;
            padding: 0 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .legend-label {
            color: #374151;
            flex: 1;
        }

        .legend-value {
            color: #6b7280;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .krs-chart-section:has(#activityCompletionChart) .chart-container {
                height: 280px;
            }

            .custom-chart-legend {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 0 10px;
            }

            .legend-item {
                font-size: 12px;
            }
        }

        .krs-charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        /* 분석 섹션 */
        .krs-analysis-section {
            margin-bottom: 24px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
        }

        .analysis-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .analysis-card.strength {
            border-left: 4px solid #22c55e;
        }

        .analysis-card.improvement {
            border-left: 4px solid #3b82f6;
        }

        .analysis-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
        }

        .analysis-header i {
            font-size: 20px;
        }

        .analysis-card.strength .analysis-header i {
            color: #22c55e;
        }

        .analysis-card.improvement .analysis-header i {
            color: #3b82f6;
        }

        .analysis-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .analysis-list li {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .analysis-list li:last-child {
            border-bottom: none;
        }

        .list-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        /* 성장 지표 */
        .krs-growth-section {
            margin-bottom: 24px;
        }

        .growth-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .growth-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }

        .growth-card:hover {
            transform: scale(1.05);
        }

        .growth-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .growth-value {
            font-size: 32px;
            font-weight: 900;
            color: #10b981;
            margin-bottom: 8px;
        }

        .growth-label {
            font-size: 14px;
            color: #1f2937;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .growth-detail {
            font-size: 12px;
            color: #6b7280;
        }

        /* 하이라이트 */
        .krs-highlights-section {
            margin-bottom: 24px;
        }

        .highlights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .highlight-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            display: flex;
            align-items: flex-start;
            gap: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .highlight-badge {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .highlight-badge.gold {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .highlight-badge.blue {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .highlight-badge.green {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .highlight-content {
            flex: 1;
        }

        .highlight-title {
            font-size: 15px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .highlight-date {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .highlight-desc {
            font-size: 13px;
            color: #4b5563;
            line-height: 1.5;
        }

        /* 점수 데이터 카드 */
        .score-data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .score-data-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .score-data-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-color: #fbbf24;
        }

        .score-data-card.highlight {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-color: #fbbf24;
        }

        .score-data-icon {
            font-size: 32px;
            flex-shrink: 0;
        }

        .score-data-content {
            flex: 1;
            min-width: 0;
        }

        .score-data-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .score-data-value {
            font-size: 28px;
            font-weight: 800;
            color: #1f2937;
            line-height: 1;
            margin-bottom: 4px;
        }

        .score-unit {
            font-size: 16px;
            font-weight: 600;
            color: #6b7280;
            margin-left: 2px;
        }

        .score-data-change {
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .score-data-change.up {
            color: #10b981;
        }

        .score-data-change.down {
            color: #ef4444;
        }

        .score-data-change i {
            font-size: 10px;
        }

        .score-data-subtitle {
            font-size: 11px;
            color: #6b7280;
            margin-top: 2px;
        }

        @media (max-width: 768px) {
            .score-data-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-data-card {
                padding: 16px;
                gap: 12px;
            }

            .score-data-icon {
                font-size: 28px;
            }

            .score-data-value {
                font-size: 24px;
            }
        }

        @media (max-width: 480px) {
            .score-data-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 인증서 */
        .krs-certificate {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 50%, #fde68a 100%);
            border-radius: 24px;
            padding: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(251, 191, 36, 0.3);
            text-align: center;
            border: 3px solid #f59e0b;
            margin-bottom: 22px;
        }

        .certificate-header {
            height: 8px;
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            border-radius: 24px 24px 0 0;
        }

        .certificate-body {
            display: flex;
            gap: 32px;
            padding: 20px 32px;
            align-items: center;
        }

        .certificate-left {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-shrink: 0;
        }

        .certificate-right {
            flex: 1;
            text-align: left;
        }

        .certificate-stars {
            font-size: 24px;
            margin-top: 20px;
            margin-bottom: 12px;
            letter-spacing: 6px;
            display: inline-block;
        }

        .certificate-stars span {
            display: inline-block;
            animation: starBounce 1.5s ease-in-out infinite;
        }

        .certificate-stars span:nth-child(1) {
            animation-delay: 0s;
        }

        .certificate-stars span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .certificate-stars span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes starBounce {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-8px) scale(1.1);
            }
        }

        .certificate-icon-wrapper {
            display: flex;
            justify-content: center;
        }

        .certificate-icon {
            font-size: 60px;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #5b4a7a 0%, #3d2f55 100%);
            border-radius: 50%;
            box-shadow: 0 8px 24px rgba(59, 47, 85, 0.3);
        }

        .certificate-title {
            font-size: 24px;
            font-weight: 900;
            color: #f97316;
            margin-bottom: 12px;
            padding: 0;
        }

        .certificate-text {
            font-size: 14px;
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 16px;
            padding: 0;
        }

        .certificate-text strong {
            color: #f97316;
            font-weight: 800;
        }

        .certificate-progress {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-bottom: 16px;
            padding: 0;
        }

        .progress-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .progress-item span:first-child {
            font-size: 13px;
            color: #6b7280;
            font-weight: 600;
        }

        .progress-value {
            font-size: 20px;
            font-weight: 800;
            color: #f97316;
        }

        .certificate-next {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 28px;
            background: linear-gradient(135deg, #fb923c, #f97316);
            color: white;
            border-radius: 24px;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 32px;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
        }

        /* 새로운 수료증 디자인 */
        .krs-certificate-new {
            display: flex;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            margin-bottom: 32px;
        }

        .certificate-decoration {
            flex: 0 0 400px;
            background: linear-gradient(135deg, #9333ea 0%, #7c3aed 50%, #6d28d9 100%);
            padding: 48px 32px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .decoration-dot {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
        }

        .decoration-dot.dot-1 {
            width: 60px;
            height: 60px;
            top: 30px;
            left: 30px;
        }

        .decoration-dot.dot-2 {
            width: 40px;
            height: 40px;
            bottom: 80px;
            left: 50px;
        }

        .decoration-dot.dot-3 {
            width: 80px;
            height: 80px;
            bottom: 40px;
            right: 40px;
        }

        .decoration-dot.dot-4 {
            width: 30px;
            height: 30px;
            top: 80px;
            right: 60px;
        }

        .certificate-badge {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5b21b6 0%, #4c1d95 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 24px 0;
            box-shadow: 0 12px 32px rgba(91, 33, 182, 0.4);
            position: relative;
            z-index: 2;
        }

        .badge-icon {
            font-size: 64px;
            color: white;
        }

        .decoration-title {
            font-size: 32px;
            font-weight: 900;
            color: white;
            margin: 20px 0 8px 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2;
        }

        .decoration-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            margin: 0;
            position: relative;
            z-index: 2;
        }

        .certificate-info {
            flex: 1;
            background: white;
            padding: 48px 40px;
        }

        .info-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .info-title {
            font-size: 28px;
            font-weight: 900;
            color: #1e293b;
            margin: 0;
        }

        .info-trophy {
            font-size: 32px;
        }

        .info-description {
            font-size: 15px;
            color: #64748b;
            margin: 0 0 32px 0;
            line-height: 1.6;
        }

        .completion-section {
            margin-bottom: 32px;
        }

        .completion-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .completion-label {
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
        }

        .completion-percent {
            font-size: 36px;
            font-weight: 900;
            color: #5b21b6;
        }

        .completion-bar {
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .completion-fill {
            height: 100%;
            background: linear-gradient(90deg, #7c3aed 0%, #5b21b6 100%);
            border-radius: 6px;
            transition: width 1s ease;
        }

        .completion-hint {
            font-size: 13px;
            color: #94a3b8;
            margin: 0;
        }

        .stats-section {
            display: flex;
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .stat-icon i {
            font-size: 18px;
            color: #f59e0b;
        }

        .stat-content {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .stat-label {
            font-size: 13px;
            color: #64748b;
            font-weight: 600;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: #1e293b;
        }

        .stat-total {
            font-size: 14px;
            font-weight: 600;
            color: #94a3b8;
        }

        .next-level-btn {
            width: 100%;
            padding: 16px 24px;
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 8px 24px rgba(249, 115, 22, 0.4);
            transition: all 0.3s ease;
        }

        .next-level-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(249, 115, 22, 0.5);
        }

        .next-level-btn i {
            font-size: 18px;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .certificate-stars {
                font-size: 24px;
                letter-spacing: 4px;
            }

            @keyframes starBounce {
                0%, 100% {
                    transform: translateY(0) scale(1);
                }
                50% {
                    transform: translateY(-8px) scale(1.1);
                }
            }

            .certificate-body {
                flex-direction: column;
                gap: 20px;
                padding: 16px 20px;
            }

            .certificate-left {
                width: 100%;
            }

            .certificate-right {
                text-align: center;
            }

            .certificate-icon {
                font-size: 50px;
                width: 90px;
                height: 90px;
            }

            .certificate-title {
                font-size: 20px;
                padding: 0;
            }

            .certificate-text {
                font-size: 13px;
                padding: 0;
                margin-bottom: 14px;
            }

            .certificate-progress {
                justify-content: center;
                gap: 24px;
            }

            .certificate-progress {
                flex-direction: column;
                gap: 16px;
                margin-bottom: 24px;
                padding: 0 24px;
            }

            .certificate-next {
                margin-bottom: 24px;
            }

            /* 새로운 수료증 모바일 */
            .krs-certificate-new {
                flex-direction: column;
            }

            .certificate-decoration {
                flex: none;
                padding: 32px 24px;
            }

            .decoration-dot.dot-1 {
                width: 40px;
                height: 40px;
                top: 20px;
                left: 20px;
            }

            .decoration-dot.dot-2 {
                width: 30px;
                height: 30px;
                bottom: 60px;
                left: 30px;
            }

            .decoration-dot.dot-3 {
                width: 60px;
                height: 60px;
                bottom: 30px;
                right: 30px;
            }

            .decoration-dot.dot-4 {
                width: 25px;
                height: 25px;
                top: 60px;
                right: 40px;
            }

            .certificate-badge {
                width: 110px;
                height: 110px;
            }

            .badge-icon {
                font-size: 52px;
            }

            .decoration-title {
                font-size: 26px;
            }

            .decoration-subtitle {
                font-size: 13px;
            }

            .certificate-info {
                padding: 32px 24px;
            }

            .info-title {
                font-size: 22px;
            }

            .info-trophy {
                font-size: 28px;
            }

            .info-description {
                font-size: 14px;
                margin-bottom: 24px;
            }

            .completion-percent {
                font-size: 32px;
            }

            .completion-bar {
                height: 10px;
            }

            .stats-section {
                flex-direction: column;
                gap: 16px;
            }

            .next-level-btn {
                padding: 14px 20px;
                font-size: 15px;
            }

            .krs-summary-grid {
                grid-template-columns: 1fr;
            }

            .recommended-card {
                flex-direction: column;
                text-align: center;
            }

            .recommended-stats {
                flex-direction: column;
            }

            .stat-divider {
                width: 60px;
                height: 2px;
            }

            .krs-charts-grid {
                grid-template-columns: 1fr;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .growth-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .highlights-grid {
                grid-template-columns: 1fr;
            }
        }

        /* === 내 책장 탭 스타일 === */
        .bookshelf-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .bookshelf-tab {
            padding: 10px 16px;
            border-radius: 20px;
            border: none;
            background: #f3f4f6;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .bookshelf-tab:hover {
            background: #e5e7eb;
        }
        .bookshelf-tab.active {
            background: linear-gradient(135deg, #FF9F43, #f59e0b);
            color: white;
        }
        .bookshelf-tab .count {
            padding: 2px 8px;
            border-radius: 10px;
            background: rgba(0,0,0,0.1);
            font-size: 11px;
        }
        .bookshelf-tab.active .count {
            background: rgba(255,255,255,0.3);
        }
        .bookshelf-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 16px;
        }
        @media (max-width: 768px) {
            .bookshelf-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
        }
        .bookshelf-book {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid #f0ebe3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            cursor: pointer;
            transition: all 0.25s;
        }
        .bookshelf-book:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        .bookshelf-book-cover {
            position: relative;
            width: 100%;
            aspect-ratio: 3/4;
            background: linear-gradient(135deg, #f5f0e8, #ebe5db);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            overflow: hidden;
        }
        .bookshelf-book-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: rgba(0,0,0,0.08);
        }
        .bookshelf-book-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 0 3px 3px 0;
        }
        .bookshelf-book-topbar {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .bookshelf-book-badge {
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
            background: rgba(16,185,129,0.9);
            color: white;
            backdrop-filter: blur(4px);
        }
        .bookshelf-fav-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #d1d5db;
            transition: all 0.2s;
            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }
        .bookshelf-fav-btn:hover { color: #f87171; transform: scale(1.15); }
        .bookshelf-fav-btn.active { color: #ef4444; }
        .bookshelf-book-info {
            padding: 12px;
        }
        .bookshelf-book-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: #1f2937;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .bookshelf-book-series {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .bookshelf-write-btn {
            width: 100%;
            margin-top: 8px;
            padding: 6px 10px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
        }
        .bookshelf-write-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.4);
        }
        .bookshelf-write-btn:active {
            transform: translateY(0);
        }
        .bookshelf-empty {
            grid-column: 1 / -1;
            text-align: center;
            padding: 48px 24px;
            color: #9ca3af;
        }
        .bookshelf-empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        .bookshelf-empty-text {
            font-size: 14px;
        }
        .bookshelf-go-library {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 16px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #FF9F43, #f59e0b);
            border-radius: 12px;
            color: white;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
        }

        /* === 갤러리 탭 스타일 === */
        .gallery-subtabs {
            display: flex;
            gap: 4px;
            margin-bottom: 16px;
            border-bottom: 1px solid #e5e7eb;
        }
        .gallery-subtab {
            flex: 1;
            padding: 12px 8px;
            border: none;
            background: transparent;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: #9ca3af;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        .gallery-subtab:hover { color: #6b7280; }
        .gallery-subtab.active {
            color: #FF9F43;
            border-bottom-color: #FF9F43;
        }
        .gallery-subtab i { margin-right: 4px; }

        /* === 갤러리 필터 === */
        .gallery-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            overflow-x: auto;
            padding-bottom: 8px;
        }
        .gallery-filter {
            flex-shrink: 0;
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid #e5e7eb;
            background: white;
            color: #6b7280;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .gallery-filter:hover {
            border-color: #d1d5db;
            background: #f9fafb;
        }
        .gallery-filter.active {
            background: #FF9F43;
            color: white;
            border-color: #FF9F43;
        }

        /* === 갤러리 정렬 버튼 === */
        .gallery-sort {
            background: transparent;
            border: none;
            color: #9ca3af;
            font-weight: 600;
            cursor: pointer;
            transition: color 0.2s;
        }
        .gallery-sort:hover {
            color: #6b7280;
        }
        .gallery-sort.active {
            color: #FF9F43;
        }

        /* === 갤러리 그리드 === */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 모바일: 2열 */
            gap: 8px;
            width: 100%;
        }
        @media (min-width: 480px) {
            .gallery-grid {
                grid-template-columns: repeat(3, 1fr); /* 작은 태블릿: 3열 */
                gap: 10px;
            }
        }
        @media (min-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(4, 1fr); /* 태블릿: 4열 */
                gap: 12px;
            }
        }
        @media (min-width: 1024px) {
            .gallery-grid {
                grid-template-columns: repeat(5, 1fr); /* 작은 데스크톱: 5열 */
                gap: 14px;
            }
        }
        @media (min-width: 1280px) {
            .gallery-grid {
                grid-template-columns: repeat(6, 1fr); /* 큰 데스크톱: 6열 */
                gap: 16px;
            }
        }

        /* === 갤러리 아이템 === */
        .gallery-item {
            position: relative;
            width: 100%;
            padding-bottom: 100%; /* 정사각형 비율 */
            overflow: hidden;
            cursor: pointer;
            border-radius: 12px;
            background: #f3f4f6;
            transition: all 0.2s;
        }
        .gallery-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .gallery-item-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }
        .gallery-item-type {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(255,255,255,0.95);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            z-index: 2;
        }
        .gallery-item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1;
        }
        .gallery-item:hover .gallery-item-overlay {
            opacity: 1;
        }
        .gallery-item-likes {
            color: white;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        .gallery-item-title {
            color: white;
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            padding: 0 8px;
        }

        /* === 갤러리 콘텐츠 === */
        .gallery-content {
            display: block;
        }
        .gallery-content.hidden {
            display: none !important;
        }

        /* === 감상문 그리드 === */
        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        @media (min-width: 480px) {
            .reviews-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        @media (min-width: 768px) {
            .reviews-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        @media (min-width: 1024px) {
            .reviews-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        /* === 감상문 카드 === */
        .review-card {
            position: relative;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid #f3f4f6;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        .review-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
            border-color: #e5e7eb;
        }
        .review-card .review-cover {
            position: relative;
            width: 100%;
            aspect-ratio: 3 / 2;
            overflow: hidden;
            background: #f3f4f6;
        }
        .review-card .review-cover img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.5s ease;
        }
        .review-card:hover .review-cover img {
            transform: scale(1.05);
        }
        .review-card .review-type-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            backdrop-filter: blur(8px);
            background: rgba(255, 255, 255, 0.95);
            color: #FF9F43;
            display: flex;
            align-items: center;
            gap: 3px;
        }
        .review-card .review-type-badge.purple { color: #8b5cf6; }
        .review-card .review-type-badge.pink { color: #F472B6; }
        .review-card .review-type-badge.amber { color: #F59E0B; }
        .review-card .review-info {
            padding: 10px 12px;
        }
        .review-card .review-info h4 {
            font-size: 13px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 3px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .review-card .review-info .review-desc {
            font-size: 11px;
            color: #9ca3af;
        }

        /* === 친구 작품 카드 === */
        .friend-work-card {
            position: relative;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            border: 2px solid #f3f4f6;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        .friend-work-card.highlight {
            border-color: #FFA726;
            box-shadow: 0 4px 20px rgba(255, 167, 38, 0.15);
        }
        .friend-work-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
        }
        .friend-work-card .friend-header {
            padding: 10px 12px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #f3f4f6;
        }
        .friend-work-card.highlight .friend-header {
            background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
        }
        .friend-work-card .friend-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .friend-work-card .friend-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        .friend-work-card .friend-details {
            flex: 1;
        }
        .friend-work-card .friend-name {
            font-size: 13px;
            font-weight: 700;
            color: #1f2937;
        }
        .friend-work-card .friend-time {
            font-size: 10px;
            color: #9ca3af;
        }
        .friend-work-card .following-badge {
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            background: #FFF3E0;
            color: #FFA726;
            border: 1px solid #FFD54F;
        }
        .friend-work-card .work-cover {
            position: relative;
            width: 100%;
            aspect-ratio: 3 / 2;
            overflow: hidden;
            background: #f3f4f6;
        }
        .friend-work-card .work-cover img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.5s ease;
        }
        .friend-work-card:hover .work-cover img {
            transform: scale(1.05);
        }
        .friend-work-card .work-footer {
            padding: 10px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .friend-work-card .like-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #9ca3af;
            transition: color 0.2s;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
        }
        .friend-work-card .like-btn.liked {
            color: #EF4444;
        }
        .friend-work-card .like-btn:hover {
            color: #EF4444;
        }

        /* === 갤러리 피드 (릴스 스타일 그리드) === */
        .gallery-feed {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 16px;
            max-width: 900px;
        }
        @media (min-width: 580px) {
            .gallery-feed {
                grid-template-columns: repeat(2, 1fr);
                gap: 14px;
            }
        }
        @media (min-width: 900px) {
            .gallery-feed {
                grid-template-columns: repeat(3, 1fr);
                gap: 14px;
            }
        }
        @media (min-width: 1200px) {
            .gallery-feed {
                grid-template-columns: repeat(4, 1fr);
                gap: 16px;
            }
        }

        /* === 피드 카드 (친구 작품 - 릴스 스타일) === */
        .feed-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.2s;
            max-width: 320px;
            width: 100%;
            justify-self: center;
        }
        .feed-card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .feed-card.highlight {
            border: 2px solid #FF9F43;
        }
        .feed-card-header {
            padding: 10px 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .feed-card-header.highlight-bg {
            background: #FFF7ED;
        }
        .feed-card-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .feed-card-visual {
            width: 100%;
            aspect-ratio: 3/4;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 56px;
        }
        .feed-card-body {
            padding: 10px 14px;
        }
        .feed-card-actions {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 6px;
        }
        .feed-card-action {
            background: transparent;
            border: none;
            color: #6b7280;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.2s;
        }
        .feed-card-action:hover {
            color: #374151;
        }
        .feed-card-action.liked {
            color: #ef4444;
        }
        .feed-card-action i {
            font-size: 14px;
        }
        /* 모바일 1컬럼: 카드 전체 너비 */
        @media (max-width: 579px) {
            .feed-card {
                max-width: 100%;
            }
            .feed-card-visual {
                aspect-ratio: 4/5;
            }
        }

        /* === 친구 카드 (관심친구) === */
        .friend-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.2s;
            max-width: 500px;
            width: 100%;
        }
        .friend-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .friend-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            flex-shrink: 0;
            aspect-ratio: 1; /* 정원 비율 유지 */
            line-height: 1; /* 이모지 중앙 정렬 */
        }

        /* === 팔로우 버튼 === */
        .follow-btn {
            padding: 6px 14px;
            border-radius: 20px;
            border: none;
            background: #FF9F43;
            color: white;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .follow-btn:hover {
            background: #FF8C1F;
            transform: scale(1.05);
        }
        .follow-btn.following {
            background: #f3f4f6;
            color: #6b7280;
        }
        .follow-btn.following:hover {
            background: #e5e7eb;
        }

        /* === 올도전 서브탭 === */
        .challenge-subtabs {
            display: flex;
            gap: 4px;
            margin-bottom: 16px;
            border-bottom: 1px solid #e5e7eb;
        }
        .challenge-subtab {
            flex: 1;
            padding: 12px 8px;
            border: none;
            background: transparent;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: #9ca3af;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        .challenge-subtab:hover { color: #6b7280; }
        .challenge-subtab.active {
            color: #FF9F43;
            border-bottom-color: #FF9F43;
        }
        .challenge-subtab i { margin-right: 4px; }

        /* === 팀 도전 스타일 === */
        .tc-group {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            align-items: stretch;
        }
        .tc-mission-card {
            background: linear-gradient(135deg, #1a1a3e 0%, #2d1b69 100%);
            border-radius: 20px;
            padding: 28px 24px;
            text-align: center;
            color: white;
            flex: 0 0 240px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .tc-team-right {
            flex: 1;
            min-width: 0;
            background: white;
            border-radius: 20px;
            padding: 20px;
            border: 1px solid #e5e7eb;
        }
        .tc-mission-badge {
            display: inline-block;
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.25);
            padding: 5px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .tc-mission-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }
        .tc-mission-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 22px;
            font-weight: 900;
            line-height: 1.4;
            margin-bottom: 16px;
        }
        .tc-mission-reward {
            display: inline-block;
            background: linear-gradient(135deg, #FF9F43, #FF6B35);
            padding: 8px 20px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 700;
        }

        /* 팀 섹션 (미사용, tc-team-right로 이전) */
        .tc-team-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .tc-team-header-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #1a1a2e;
        }
        .tc-team-header-title strong {
            color: #7C3AED;
            font-weight: 800;
        }
        .tc-team-dday {
            background: #FEF3C7;
            color: #D97706;
            font-size: 12px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 12px;
        }

        /* 대표 팀원 카드 */
        .tc-featured-card {
            background: linear-gradient(135deg, #8B5CF6, #A855F7, #C084FC);
            border-radius: 16px;
            padding: 24px 20px;
            text-align: center;
            color: white;
            margin-bottom: 16px;
            position: relative;
        }
        .tc-rank-badge {
            display: inline-block;
            background: linear-gradient(135deg, #FF9F43, #F59E0B);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
        }
        .tc-featured-avatar {
            width: 64px;
            height: 64px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto 10px;
            border: 3px solid rgba(255,255,255,0.4);
        }
        .tc-featured-name {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 2px;
        }
        .tc-featured-info {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 10px;
        }
        .tc-featured-quote {
            font-size: 13px;
            opacity: 0.9;
            line-height: 1.5;
            margin-bottom: 14px;
            font-style: italic;
        }
        .tc-featured-result { margin-bottom: 6px; }
        .tc-result-success {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            padding: 4px 14px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 600;
        }
        .tc-featured-reward {
            font-size: 14px;
            font-weight: 700;
            opacity: 0.9;
        }

        /* 팀원 리스트 */
        .tc-members-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .tc-member-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 14px;
            padding: 14px;
        }
        .tc-member-top {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            position: relative;
        }
        .tc-member-avatar {
            width: 36px;
            height: 36px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            border: 2px solid #e5e7eb;
            flex-shrink: 0;
        }
        .tc-member-name {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: #1a1a2e;
        }
        .tc-member-info {
            font-size: 10px;
            color: #9ca3af;
        }
        .tc-member-desc {
            font-size: 11px;
            color: #6b7280;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        .tc-member-status {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }
        .tc-status-progress {
            font-size: 11px;
            color: #3B82F6;
            font-weight: 600;
        }
        .tc-status-fail {
            font-size: 11px;
            color: #EF4444;
            font-weight: 600;
        }
        .tc-status-ready {
            font-size: 11px;
            color: #9ca3af;
            font-weight: 600;
        }
        .tc-progress-bar {
            flex: 1;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            min-width: 40px;
        }
        .tc-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3B82F6, #60A5FA);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        .tc-progress-text {
            font-size: 11px;
            color: #3B82F6;
            font-weight: 700;
        }
        .tc-help-btn {
            display: inline-block;
            background: linear-gradient(135deg, #10B981, #34D399);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 4px;
        }
        .tc-rank-badge-sm {
            position: absolute;
            top: -8px;
            right: -4px;
            background: linear-gradient(135deg, #FF9F43, #F59E0B);
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 9px;
            font-weight: 700;
            color: white;
        }

        /* 나도 한마디 */
        .tc-comment-section {
            background: linear-gradient(135deg, #4C1D95, #6D28D9, #7C3AED);
            border-radius: 20px;
            padding: 24px 16px 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }
        .tc-comment-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 18px;
            font-weight: 800;
            color: white;
            text-align: center;
            margin-bottom: 16px;
        }
        .tc-marquee-wrap {
            overflow: hidden;
            padding-bottom: 8px;
        }
        .tc-marquee-track {
            display: flex;
            gap: 12px;
            width: max-content;
            animation: tcMarquee 60s linear infinite;
        }
        .tc-marquee-wrap:hover .tc-marquee-track {
            animation-play-state: paused;
        }
        @keyframes tcMarquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .tc-comment-card {
            flex-shrink: 0;
            width: 160px;
            background: rgba(255,255,255,0.95);
            border-radius: 14px;
            padding: 14px;
        }
        /* 둥둥 떠다니는 모션 3종 */
        .tc-float-1 {
            animation: tcFloat1 3.2s ease-in-out infinite;
        }
        .tc-float-2 {
            animation: tcFloat2 4.0s ease-in-out infinite;
        }
        .tc-float-3 {
            animation: tcFloat3 3.6s ease-in-out infinite;
        }
        @keyframes tcFloat1 {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        @keyframes tcFloat2 {
            0%, 100% { transform: translateY(0); }
            35% { transform: translateY(-6px); }
            70% { transform: translateY(3px); }
        }
        @keyframes tcFloat3 {
            0%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            75% { transform: translateY(2px); }
        }
        .tc-comment-name {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 800;
            color: #1a1a2e;
            margin-bottom: 1px;
        }
        .tc-comment-info {
            font-size: 10px;
            color: #9ca3af;
            margin-bottom: 8px;
        }
        .tc-comment-text {
            font-size: 13px;
            color: #4B5563;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        .tc-comment-team {
            display: inline-block;
            color: white;
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
        }
        .tc-write-btn {
            position: absolute;
            bottom: 16px;
            right: 16px;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #F59E0B, #FF9F43);
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(245,158,11,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 다음 주 미션 고르기 */
        .tc-next-section {
            margin-bottom: 20px;
        }
        .tc-next-header {
            margin-bottom: 14px;
        }
        .tc-next-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 17px;
            font-weight: 800;
            color: #1a1a2e;
            margin-bottom: 4px;
        }
        .tc-next-notice {
            font-size: 11px;
            color: #9ca3af;
        }
        .tc-next-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .tc-next-card {
            background: white;
            border: 1.5px solid #e5e7eb;
            border-radius: 16px;
            padding: 18px 14px;
            text-align: center;
        }
        .tc-next-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .tc-next-card-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 8px;
            line-height: 1.4;
            min-height: 36px;
        }
        .tc-next-ai {
            display: inline-block;
            background: #EDE9FE;
            color: #7C3AED;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .tc-next-meta {
            display: flex;
            justify-content: center;
            gap: 12px;
            font-size: 11px;
            color: #6b7280;
            margin-bottom: 12px;
        }
        .tc-next-btn {
            width: 100%;
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            color: white;
            border: none;
            padding: 9px 0;
            border-radius: 12px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tc-next-btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .tc-next-btn.selected {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        /* 랜덤 미션 */
        .tc-next-random {
            border-color: #F59E0B;
            border-width: 2px;
            background: #FFFBEB;
        }
        .tc-random-title {
            color: #D97706 !important;
            font-size: 16px !important;
            font-weight: 900 !important;
        }
        .tc-next-random-desc {
            font-size: 12px;
            color: #92400E;
            margin-bottom: 12px;
        }
        .tc-next-btn-random {
            background: linear-gradient(135deg, #F59E0B, #D97706) !important;
        }

        @media (max-width: 768px) {
            .tc-group { flex-direction: column; }
            .tc-mission-card { flex: none; }
            .tc-members-grid { grid-template-columns: 1fr; }
            .tc-next-grid { grid-template-columns: 1fr 1fr; }
            .tc-comment-card { width: 140px; }
        }

        /* ===== 명예의전당 스타일 ===== */
        .fame-section {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
            border: 1px solid #f0f0f0;
        }
        .fame-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .fame-section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 17px;
            font-weight: 800;
            color: #1a1a2e;
        }
        .fame-section-title i {
            color: #F59E0B;
            font-size: 18px;
        }
        .fame-help-btn {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid #d1d5db;
            background: transparent;
            color: #9ca3af;
            font-size: 11px;
            font-weight: 800;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fame-year-select {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px 14px;
            border: 1.5px solid #e5e7eb;
            border-radius: 20px;
            background: white;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: #374151;
            cursor: pointer;
        }
        .fame-year-select i { font-size: 10px; color: #9ca3af; }

        /* 상장 카드 슬라이더 */
        .fame-scroll-wrap {
            overflow-x: auto;
            padding-bottom: 4px;
        }
        .fame-scroll-wrap::-webkit-scrollbar { display: none; }
        .fame-scroll-track {
            display: flex;
            gap: 14px;
        }

        /* 상장 카드 */
        .fame-award-card {
            flex-shrink: 0;
            width: 130px;
            background: white;
            border: 1.5px solid #f0f0f0;
            border-radius: 16px;
            padding: 14px 10px 12px;
            text-align: center;
            position: relative;
            transition: all 0.2s;
        }
        .fame-award-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }
        .fame-month-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 800;
            color: white;
        }
        .fame-month-badge.green { background: #10B981; }
        .fame-month-badge.yellow { background: #F59E0B; }
        .fame-month-badge.red { background: #EF4444; }
        .fame-month-badge.blue { background: #3B82F6; }
        .fame-month-badge.purple { background: #8B5CF6; }
        .fame-trophy {
            width: 70px;
            height: 70px;
            margin: 8px auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            position: relative;
        }
        .fame-trophy .sparkle {
            position: absolute;
            font-size: 14px;
            animation: fameTwinkle 1.5s ease-in-out infinite;
        }
        .fame-trophy .sparkle:nth-child(2) { top: -2px; right: 2px; animation-delay: 0.5s; }
        .fame-trophy .sparkle:nth-child(3) { top: 8px; left: 0; animation-delay: 1s; }
        @keyframes fameTwinkle {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        .fame-star-badge {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 800;
            margin-bottom: 6px;
        }
        .fame-star-badge.gold { background: #FEF3C7; color: #D97706; }
        .fame-star-badge.green { background: #D1FAE5; color: #059669; }
        .fame-star-badge.blue { background: #DBEAFE; color: #2563EB; }
        .fame-star-badge.red { background: #FEE2E2; color: #DC2626; }
        .fame-star-badge.purple { background: #EDE9FE; color: #7C3AED; }
        .fame-award-name {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: #6b7280;
        }
        /* 빈 카드 (아직 안받은 달) */
        .fame-award-card.empty {
            border-style: dashed;
            border-color: #e5e7eb;
            background: #fafafa;
        }
        .fame-award-card.empty .fame-trophy {
            opacity: 0.25;
            filter: grayscale(1);
        }

        /* 나의 배지 그리드 */
        .fame-badge-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 12px;
        }
        .fame-badge-card {
            background: white;
            border: 1.5px solid #f0f0f0;
            border-radius: 16px;
            padding: 18px 10px 14px;
            text-align: center;
            transition: all 0.2s;
            position: relative;
        }
        .fame-badge-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .fame-badge-card.highlight-pink {
            background: linear-gradient(135deg, #FFF1F2, #FFE4E6);
            border-color: #FECDD3;
        }
        .fame-badge-card.highlight-green {
            background: linear-gradient(135deg, #F0FDF4, #DCFCE7);
            border-color: #BBF7D0;
        }
        .fame-badge-icon {
            font-size: 36px;
            margin-bottom: 10px;
            display: block;
        }
        .fame-badge-name {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: #374151;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
        }
        .fame-badge-name i { font-size: 9px; }
        .fame-badge-reward {
            font-size: 11px;
            font-weight: 700;
            color: #F59E0B;
        }
        .fame-badge-card.locked {
            background: #f9fafb;
            border-style: dashed;
            border-color: #e5e7eb;
        }
        .fame-badge-card.locked .fame-badge-icon {
            font-size: 28px;
            opacity: 0.3;
        }
        .fame-badge-card.locked .fame-badge-name,
        .fame-badge-card.locked .fame-badge-reward {
            color: #d1d5db;
        }
        .fame-team-link {
            padding: 8px 18px;
            border-radius: 20px;
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            border: none;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }
        .fame-team-link:hover { opacity: 0.9; transform: translateY(-1px); }

        @media (max-width: 768px) {
            .fame-badge-grid { grid-template-columns: repeat(3, 1fr); }
            .fame-award-card { width: 110px; }
        }

        /* === 프로필 변경 모달 === */
        .profile-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.5);
        }
        .profile-modal.show {
            display: flex;
        }
        .profile-modal-content {
            background: white;
            border-radius: 24px;
            padding: 28px;
            max-width: 360px;
            width: 90%;
            text-align: center;
        }
        .profile-modal-title {
            font-size: 18px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
        }
        .profile-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        .profile-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s;
        }
        .profile-option:hover {
            transform: scale(1.1);
        }
        .profile-option.selected {
            border-color: #FF9F43;
            box-shadow: 0 0 0 3px rgba(255,159,67,0.2);
        }
        .profile-modal-close {
            padding: 12px 24px;
            background: #f3f4f6;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            border: none;
            margin-right: 8px;
        }
        .profile-modal-save {
            padding: 12px 24px;
            background: linear-gradient(135deg, #FF9F43, #f59e0b);
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            border: none;
        }
    </style>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-50 font-sans text-gray-800 h-screen overflow-hidden">
    <!-- 모바일 햄버거 버튼 -->
    <button class="sidebar-toggle" id="sidebar-toggle-btn" onclick="toggleSidebar()">
        <i class="fa-solid fa-bars text-gray-600 text-lg"></i>
    </button>

    <!-- 사이드바 오버레이 -->
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="flex w-full h-full">
        <!-- Sidebar Container -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <main class="flex-1 h-full overflow-y-auto px-6 py-8 md:px-12 bg-gradient-to-b from-gray-50 to-white">
            <div class="max-w-[1400px]">
                <!-- 페이지 헤더 -->
                <div class="mb-6">
                    <h1 class="font-noto text-2xl font-bold text-gray-800">마이페이지</h1>
                </div>

                <!-- 탭 메뉴 -->
                <div class="mypage-tabs">
                    <button class="mypage-tab active" data-tab="my">MY</button>
                    <button class="mypage-tab" data-tab="report">리포트</button>
                    <button class="mypage-tab" data-tab="bookshelf">내 책장</button>
                    <button class="mypage-tab" data-tab="gallery">갤러리</button>
                    <button class="mypage-tab" data-tab="fame">명예의전당</button>
                </div>

                <!-- MY 탭 콘텐츠 -->
                <div id="tab-my" class="tab-content">
                    <div class="my-grid">
                        <!-- 1. 내 현황 (확장) -->
                        <div class="my-card my-card-full">
                            <h3 class="my-card-title"><i class="fa-solid fa-user text-brand-primary"></i> 내 현황</h3>

                            <div class="my-status-container">
                                <!-- 1. 상단 그룹: 프로필 + 별 + 스타샵 -->
                                <div class="status-group-top">
                                    <!-- 프로필 섹션 -->
                                    <div class="profile-section">
                                        <div class="profile-photo" onclick="openProfileModal()">
                                            <span id="profile-emoji">😎</span>
                                            <div class="profile-photo-edit">
                                                <i class="fa-solid fa-camera"></i>
                                            </div>
                                        </div>
                                        <div>
                                            <p class="font-noto text-lg font-bold text-gray-800">우희</p>
                                            <p class="text-sm text-gray-500">3학년 2반</p>
                                        </div>
                                    </div>

                                    <!-- 별 + 스타샵 섹션 -->
                                    <div class="stars-section">
                                        <div class="star-display">
                                            <span style="font-size:32px;">⭐</span>
                                            <div>
                                                <div class="star-count-num">5,788</div>
                                                <div class="star-count-label">내가 모은 별</div>
                                            </div>
                                        </div>
                                        <a href="starshop.html" class="starshop-btn">
                                            <i class="fa-solid fa-store"></i>
                                            <span>스타샵 가기</span>
                                        </a>
                                    </div>
                                </div>

                                <!-- 2. 나의 독서 활동 그룹 -->
                                <div class="status-group-activity">
                                    <h3 class="activity-header">📚 나의 독서 활동</h3>

                                    <!-- 독서점수 & 취향 -->
                                    <div class="activity-info-row">
                                        <div class="activity-info-item">
                                            <div class="activity-info-label">나의 독서점수</div>
                                            <div class="activity-info-value">
                                                550점 <span class="activity-info-badge">승급 도전 중!</span>
                                            </div>
                                        </div>
                                        <div class="activity-info-item">
                                            <div class="activity-info-label">나의 독서 취향</div>
                                            <div class="activity-info-value">
                                                📚 만화가 좋아!
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 5개 활동 카드 (1x5) -->
                                    <div class="activity-grid">
                                        <!-- 1. 최근 출석일 -->
                                        <div class="activity-card attendance-card">
                                            <div class="activity-card-icon">🔥</div>
                                            <div class="activity-card-content">
                                                <div class="activity-card-label">최근 출석일</div>
                                                <div class="activity-card-value">2026.02.10</div>
                                                <div class="activity-card-badge">연속 7일!</div>
                                            </div>
                                        </div>

                                        <!-- 2. 나의 감상문 -->
                                        <div class="activity-card review-card">
                                            <div class="activity-card-thumbnail">
                                                <div class="default-review-cover">감상문</div>
                                            </div>
                                            <div class="activity-card-content">
                                                <div class="activity-card-label">나의 감상문</div>
                                                <div class="activity-card-title">해리포터와 마법사의 돌</div>
                                                <div class="activity-card-date">2026.02.08</div>
                                            </div>
                                        </div>

                                        <!-- 3. 내가 획득한 단어 -->
                                        <div class="activity-card word-card">
                                            <div class="activity-card-icon">📝</div>
                                            <div class="activity-card-content">
                                                <div class="activity-card-label">획득한 단어</div>
                                                <div class="activity-card-word">매끈매끈하다</div>
                                                <div class="activity-card-badge">+5 단어</div>
                                            </div>
                                        </div>

                                        <!-- 4. 내가 획득한 상장 -->
                                        <div class="activity-card award-card">
                                            <div class="activity-card-icon">🏆</div>
                                            <div class="activity-card-content">
                                                <div class="activity-card-label">획득한 상장</div>
                                                <div class="activity-card-award">책사랑상</div>
                                                <div class="activity-card-date">2026.01.15</div>
                                            </div>
                                        </div>

                                        <!-- 5. 내가 받은 뱃지 -->
                                        <div class="activity-card badge-card">
                                            <div class="activity-card-icon">🎖️</div>
                                            <div class="activity-card-content">
                                                <div class="activity-card-label">받은 뱃지</div>
                                                <div class="activity-card-badge-name">독서왕</div>
                                                <div class="activity-card-badge">3개 보유</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 2. 독서로 키재기 (가로형, 2단 full-width) -->
                        <div class="my-card my-card-full">
                            <h3 class="my-card-title">
                                <i class="fa-solid fa-ruler-vertical text-amber-500"></i> 독서로 키재기
                                <button class="height-info-btn" onclick="openMilestoneModal()" title="어디까지 클 수 있을까?">
                                    <i class="fa-solid fa-circle-info"></i>
                                    <span>어디까지 클 수 있을까?</span>
                                </button>
                            </h3>

                            <div class="height-layout">
                                <!-- 좌측: 캐릭터 시각화 -->
                                <div class="height-meter">
                                    <div class="height-progress-badge">20%</div>
                                    <div class="height-figure">
                                        <img src="../img/king.png" alt="세종대왕">
                                    </div>
                                </div>

                                <!-- 우측: 정보 영역 -->
                                <div class="height-info">
                                    <div class="height-target">
                                        <div>
                                            <div class="height-target-label">현재 목표</div>
                                            <div class="height-target-name">세종대왕</div>
                                        </div>
                                    </div>

                                    <!-- 프로그래스바 -->
                                    <div>
                                        <div class="height-progress-bar">
                                            <div class="height-progress-fill" style="width: 20%;"></div>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;margin-top:6px;">
                                            <span style="font-size:11px;color:#9ca3af;">0권</span>
                                            <span style="font-size:11px;color:#9ca3af;">5,000권</span>
                                        </div>
                                    </div>

                                    <!-- 통계 -->
                                    <div class="height-stats">
                                        <div class="height-stat-item">
                                            <div class="height-stat-num">1,000권</div>
                                            <div class="height-stat-label">여태까지 읽은 도서</div>
                                        </div>
                                        <div class="height-stat-item">
                                            <div class="height-stat-num" style="color:#10b981;">4,000권</div>
                                            <div class="height-stat-label">목표까지 남은 도서</div>
                                        </div>
                                    </div>

                                    <!-- 다음 목표 -->
                                    <div class="height-next">
                                        <span class="height-next-icon">🗽</span>
                                        <div class="height-next-text">
                                            다음 목표: <span class="height-next-name">자유의 여신상</span> (250권 더!)
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 리포트 탭 콘텐츠 -->
                <div id="tab-report" class="tab-content hidden">
                    <!-- 월간/KRS 토글 -->
                    <div class="report-toggle">
                        <button class="report-toggle-btn active" data-report="monthly" onclick="switchReportType('monthly')">월간 리포트</button>
                        <button class="report-toggle-btn" data-report="krs" onclick="switchReportType('krs')">KRS 레벨 리포트</button>
                    </div>

                    <!-- ===== 월간 리포트 ===== -->
                    <div id="report-monthly" class="report-content">
                        <div class="report-period">
                            <strong>2026년 1월</strong> · 월간 종합 리포트
                        </div>

                        <!-- 독서력 & 레벨 -->
                        <div class="report-power-grid">
                            <!-- 독서 전투력 -->
                            <div class="report-power-card">
                                <div class="report-power-gauge">
                                    <svg viewBox="0 0 100 100" width="120" height="120">
                                        <circle cx="50" cy="50" r="42" fill="none" stroke="#fed7aa" stroke-width="10"/>
                                        <circle cx="50" cy="50" r="42" fill="none" stroke="url(#powerGradient)" stroke-width="10"
                                                stroke-linecap="round" stroke-dasharray="264" stroke-dashoffset="56"/>
                                        <defs>
                                            <linearGradient id="powerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                <stop offset="0%" stop-color="#f97316"/>
                                                <stop offset="100%" stop-color="#fbbf24"/>
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                    <div class="report-power-center">
                                        <span class="report-power-score">898</span>
                                        <span class="report-power-unit">점</span>
                                    </div>
                                </div>
                                <div class="report-power-info">
                                    <h4>독서 전투력</h4>
                                    <span class="report-power-rank">🏆 상위 12%</span>
                                    <p style="font-size:12px; color:#6b7280; margin-top:8px;">지난달 대비 +124점</p>
                                </div>
                            </div>
                            <!-- 레벨 정보 -->
                            <div class="report-level-card">
                                <div class="report-level-badge">
                                    <span class="report-level-num">5</span>
                                    <span class="report-level-label">Level</span>
                                </div>
                                <div class="report-level-info">
                                    <h4>Lv.5 → Lv.6 진행 중</h4>
                                    <div class="report-level-bar">
                                        <div class="report-level-fill" style="width: 78%;"></div>
                                    </div>
                                    <span class="report-level-text">레벨업까지 약 2주 남음</span>
                                </div>
                            </div>
                        </div>

                        <!-- 핵심 지표 -->
                        <div class="report-stats-grid">
                            <div class="report-stat-item">
                                <div class="report-stat-icon" style="background: #fef3c7;">📚</div>
                                <div class="report-stat-value">45권</div>
                                <div class="report-stat-label">읽은 도서</div>
                                <div class="report-stat-change up"><i class="fa-solid fa-arrow-up"></i> +12</div>
                            </div>
                            <div class="report-stat-item">
                                <div class="report-stat-icon" style="background: #dbeafe;">⏱️</div>
                                <div class="report-stat-value">18.4h</div>
                                <div class="report-stat-label">독서 시간</div>
                                <div class="report-stat-change up"><i class="fa-solid fa-arrow-up"></i> +3h</div>
                            </div>
                            <div class="report-stat-item">
                                <div class="report-stat-icon" style="background: #dcfce7;">📈</div>
                                <div class="report-stat-value">92%</div>
                                <div class="report-stat-label">퀴즈 정답률</div>
                                <div class="report-stat-change up"><i class="fa-solid fa-arrow-up"></i> +5%</div>
                            </div>
                            <div class="report-stat-item">
                                <div class="report-stat-icon" style="background: #fce7f3;">⭐</div>
                                <div class="report-stat-value">1,024</div>
                                <div class="report-stat-label">획득한 별</div>
                                <div class="report-stat-change up"><i class="fa-solid fa-arrow-up"></i> +256</div>
                            </div>
                        </div>

                        <!-- 능력 분석 -->
                        <div class="report-card">
                            <h3 class="report-card-title">
                                <i class="fa-solid fa-brain" style="color: #8b5cf6;"></i>
                                독서 능력 분석
                            </h3>
                            <div class="report-ability-chart">
                                <svg viewBox="-30 -10 260 220" width="280" height="220">
                                    <polygon points="100,20 175,60 175,140 100,180 25,140 25,60" fill="none" stroke="#e5e7eb" stroke-width="1"/>
                                    <polygon points="100,50 150,75 150,125 100,150 50,125 50,75" fill="none" stroke="#e5e7eb" stroke-width="1"/>
                                    <polygon points="100,80 125,90 125,110 100,120 75,110 75,90" fill="none" stroke="#e5e7eb" stroke-width="1"/>
                                    <polygon points="100,35 160,70 145,130 100,155 55,130 40,70" fill="rgba(139, 92, 246, 0.15)" stroke="#8b5cf6" stroke-width="2"/>
                                    <text x="100" y="10" text-anchor="middle" style="font-size:11px; font-weight:600; fill:#374151;">이해력</text>
                                    <text x="185" y="60" text-anchor="start" style="font-size:11px; font-weight:600; fill:#374151;">추론</text>
                                    <text x="185" y="150" text-anchor="start" style="font-size:11px; font-weight:600; fill:#374151;">어휘</text>
                                    <text x="100" y="200" text-anchor="middle" style="font-size:11px; font-weight:600; fill:#374151;">표현</text>
                                    <text x="15" y="150" text-anchor="end" style="font-size:11px; font-weight:600; fill:#374151;">창의</text>
                                    <text x="15" y="60" text-anchor="end" style="font-size:11px; font-weight:600; fill:#374151;">기억</text>
                                </svg>
                            </div>
                            <div class="report-ability-summary">
                                ✨ <b>이해력</b>과 <b>추론 능력</b>이 뛰어나요! 창의력을 더 키워보세요.
                            </div>
                        </div>

                        <!-- 주차별 독서량 -->
                        <div class="report-card">
                            <h3 class="report-card-title">
                                <i class="fa-solid fa-chart-line" style="color: #3b82f6;"></i>
                                주차별 독서량
                            </h3>
                            <div class="report-bar-list">
                                <div class="report-bar-item">
                                    <div class="report-bar-label">1주차</div>
                                    <div class="report-bar-track">
                                        <div class="report-bar-fill" style="width: 75%; background: linear-gradient(90deg, #FF9F43, #fbbf24);">9권</div>
                                    </div>
                                </div>
                                <div class="report-bar-item">
                                    <div class="report-bar-label">2주차</div>
                                    <div class="report-bar-track">
                                        <div class="report-bar-fill" style="width: 100%; background: linear-gradient(90deg, #FF9F43, #fbbf24);">12권</div>
                                    </div>
                                </div>
                                <div class="report-bar-item">
                                    <div class="report-bar-label">3주차</div>
                                    <div class="report-bar-track">
                                        <div class="report-bar-fill" style="width: 100%; background: linear-gradient(90deg, #FF9F43, #fbbf24);">12권</div>
                                    </div>
                                </div>
                                <div class="report-bar-item">
                                    <div class="report-bar-label">4주차</div>
                                    <div class="report-bar-track">
                                        <div class="report-bar-fill" style="width: 100%; background: linear-gradient(90deg, #FF9F43, #fbbf24);">12권</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI 버디 코칭 -->
                        <div class="report-ai-card">
                            <div class="report-ai-header">
                                <div class="report-ai-avatar">🐿️</div>
                                <div class="report-ai-name">AI 버디의 한마디</div>
                            </div>
                            <p class="report-ai-message">
                                <b>와우!</b> 이번 달 독서량이 정말 많이 늘었어요!
                                특히 <b>과학 분야</b>에 관심이 많네요.
                                다음 달엔 <b>역사책</b>도 도전해볼까요? 🚀
                            </p>
                        </div>

                        <!-- 월간 성취 & 뱃지 -->
                        <div class="report-card" style="margin-top: 20px;">
                            <h3 class="report-card-title">
                                <i class="fa-solid fa-trophy" style="color: #f59e0b;"></i>
                                1월 성취
                            </h3>
                            <div class="report-highlight-list">
                                <div class="report-highlight-item">
                                    <div class="report-highlight-icon" style="background: linear-gradient(135deg, #fef3c7, #fde68a);">🎯</div>
                                    <div class="report-highlight-info">
                                        <div class="report-highlight-title">월간 목표 달성!</div>
                                        <div class="report-highlight-desc">목표 30권 중 45권 완료 (150%)</div>
                                    </div>
                                    <div class="report-highlight-badge" style="background: #fef3c7; color: #d97706;">🏆</div>
                                </div>
                                <div class="report-highlight-item">
                                    <div class="report-highlight-icon" style="background: linear-gradient(135deg, #dbeafe, #bfdbfe);">🔥</div>
                                    <div class="report-highlight-info">
                                        <div class="report-highlight-title">23일 출석</div>
                                        <div class="report-highlight-desc">출석률 74%</div>
                                    </div>
                                    <div class="report-highlight-badge" style="background: #dbeafe; color: #2563eb;">Good!</div>
                                </div>
                            </div>
                        </div>

                        <div class="report-card">
                            <h3 class="report-card-title">
                                <i class="fa-solid fa-medal" style="color: #8b5cf6;"></i>
                                1월 획득 뱃지
                            </h3>
                            <div class="report-badge-list">
                                <div class="report-badge"><span class="report-badge-icon">📚</span><span class="report-badge-text">다독가</span></div>
                                <div class="report-badge"><span class="report-badge-icon">🎯</span><span class="report-badge-text">목표달성왕</span></div>
                                <div class="report-badge"><span class="report-badge-icon">💡</span><span class="report-badge-text">질문마스터</span></div>
                                <div class="report-badge"><span class="report-badge-icon">🔥</span><span class="report-badge-text">연속출석7일</span></div>
                                <div class="report-badge"><span class="report-badge-icon">⭐</span><span class="report-badge-text">1000스타</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- ===== KRS 레벨 리포트 (전문적 리포트) ===== -->
                    <div id="report-krs" class="report-content hidden">

                        <!-- 리포트 헤더 -->
                        <div class="krs-report-header">
                            <div class="krs-report-period">
                                <span class="period-label">학습 기간</span>
                                <span class="period-value">2025년 9월 ~ 2026년 2월 (6개월)</span>
                            </div>
                            <div class="krs-report-level">
                                <div class="level-badge">
                                    <i class="fa-solid fa-graduation-cap"></i>
                                    <span>K1-2 레벨 종합 리포트</span>
                                </div>
                                <div class="level-status completed">레벨 완료</div>
                            </div>
                        </div>

                        <!-- 레벨 완료 인증서 스타일 -->
                        <div class="krs-certificate">
                            <div class="certificate-header"></div>
                            <div class="certificate-stars">
                                <span>⭐</span><span>⭐</span><span>⭐</span>
                            </div>
                            <div class="certificate-icon-wrapper">
                                <div class="certificate-icon">🎓</div>
                            </div>
                            <h2 class="certificate-title">K1-2 레벨 수료 완료!</h2>
                            <p class="certificate-text">
                                6개월간의 열정적인 학습으로<br/>
                                <strong>92%의 높은 완료율</strong>을 달성했습니다.
                            </p>
                            <div class="certificate-progress">
                                <div class="progress-item">
                                    <span>필수 학습</span>
                                    <span class="progress-value">38/42 완료</span>
                                </div>
                                <div class="progress-item">
                                    <span>추천 학습</span>
                                    <span class="progress-value">48권 완독</span>
                                </div>
                            </div>
                            <div class="certificate-next">
                                <i class="fa-solid fa-arrow-right"></i>
                                <span>다음 레벨: K2-1</span>
                            </div>
                        </div>

                        <!-- 핵심 성과 요약 -->
                        <div class="krs-summary-grid">
                            <div class="krs-summary-card primary">
                                <div class="summary-icon">📚</div>
                                <div class="summary-content">
                                    <div class="summary-label">KRS 메인도서</div>
                                    <div class="summary-value">22<span class="summary-total">/24</span></div>
                                    <div class="summary-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 92%;"></div>
                                        </div>
                                        <span class="progress-text">92% 완료</span>
                                    </div>
                                </div>
                            </div>

                            <div class="krs-summary-card secondary">
                                <div class="summary-icon">📖</div>
                                <div class="summary-content">
                                    <div class="summary-label">교과서 짝꿍책</div>
                                    <div class="summary-value">20<span class="summary-total">/24</span></div>
                                    <div class="summary-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill blue" style="width: 83%;"></div>
                                        </div>
                                        <span class="progress-text">83% 완료</span>
                                    </div>
                                </div>
                            </div>

                            <div class="krs-summary-card success">
                                <div class="summary-icon">✅</div>
                                <div class="summary-content">
                                    <div class="summary-label">독후 퀴즈</div>
                                    <div class="summary-value">16<span class="summary-total">/18</span></div>
                                    <div class="summary-meta">
                                        <span class="meta-badge score-high">평균 87점</span>
                                        <span class="meta-text">⭐ 우수</span>
                                    </div>
                                </div>
                            </div>

                            <div class="krs-summary-card accent">
                                <div class="summary-icon">🎮</div>
                                <div class="summary-content">
                                    <div class="summary-label">AI 어휘 챌린지</div>
                                    <div class="summary-value">12<span class="summary-total">/14</span></div>
                                    <div class="summary-meta">
                                        <span class="meta-badge score-medium">평균 82점</span>
                                        <span class="meta-text">✨ 양호</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- KRS 추천도서 섹션 -->
                        <div class="krs-recommended-section">
                            <h3 class="section-title">
                                <i class="fa-solid fa-star"></i>
                                KRS 추천도서 독서 현황
                            </h3>
                            <div class="recommended-card">
                                <div class="recommended-stats">
                                    <div class="stat-main">
                                        <span class="stat-number">48</span>
                                        <span class="stat-label">권 완독</span>
                                    </div>
                                    <div class="stat-divider"></div>
                                    <div class="stat-sub">
                                        <span class="stat-total">총 202권 중</span>
                                        <span class="stat-percent">23.8%</span>
                                    </div>
                                </div>
                                <div class="recommended-ranking">
                                    <div class="ranking-badge top">
                                        <i class="fa-solid fa-trophy"></i>
                                        <span>상위 15%</span>
                                    </div>
                                    <div class="ranking-text">동일 레벨 친구들 중</div>
                                </div>
                                <div class="recommended-progress-ring">
                                    <svg width="120" height="120">
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="#e5e7eb" stroke-width="8"></circle>
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="#fbbf24" stroke-width="8"
                                                stroke-dasharray="339.292" stroke-dashoffset="258"
                                                stroke-linecap="round" transform="rotate(-90 60 60)"></circle>
                                        <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="800" fill="#1f2937">24%</text>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <!-- 월별 독서량 그래프 -->
                        <div class="krs-chart-section">
                            <h3 class="section-title">
                                <i class="fa-solid fa-chart-line"></i>
                                월별 독서량 추이
                            </h3>
                            <div class="chart-container">
                                <canvas id="monthlyReadingChart"></canvas>
                            </div>
                        </div>

                        <!-- 활동별 완료율 & 점수 추이 -->
                        <div class="krs-charts-grid">
                            <div class="krs-chart-section">
                                <h3 class="section-title">
                                    <i class="fa-solid fa-chart-pie"></i>
                                    활동별 완료율
                                </h3>
                                <div class="chart-container small">
                                    <canvas id="activityCompletionChart"></canvas>
                                </div>
                                <!-- 커스텀 범례 (2x2 그리드) -->
                                <div class="custom-chart-legend">
                                    <div class="legend-item">
                                        <span class="legend-color" style="background-color: #3b82f6;"></span>
                                        <span class="legend-label">KRS 메인도서</span>
                                        <span class="legend-value">91.7%</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color" style="background-color: #10b981;"></span>
                                        <span class="legend-label">교과서 짝꿍책</span>
                                        <span class="legend-value">83.3%</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color" style="background-color: #f59e0b;"></span>
                                        <span class="legend-label">독후 퀴즈</span>
                                        <span class="legend-value">88.9%</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color" style="background-color: #8b5cf6;"></span>
                                        <span class="legend-label">AI 어휘 챌린지</span>
                                        <span class="legend-value">85.7%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="krs-chart-section">
                                <h3 class="section-title">
                                    <i class="fa-solid fa-chart-area"></i>
                                    점수 추이 (퀴즈 & 어휘)
                                </h3>
                                <div class="chart-container small">
                                    <canvas id="scoreTrendChart"></canvas>
                                </div>
                                <!-- 점수 상세 데이터 -->
                                <div class="score-data-grid">
                                    <div class="score-data-card">
                                        <div class="score-data-icon">📝</div>
                                        <div class="score-data-content">
                                            <div class="score-data-label">독후 퀴즈 평균</div>
                                            <div class="score-data-value">88.0<span class="score-unit">점</span></div>
                                            <div class="score-data-change up">
                                                <i class="fa-solid fa-arrow-up"></i> 지난 달 대비 +3점
                                            </div>
                                        </div>
                                    </div>
                                    <div class="score-data-card">
                                        <div class="score-data-icon">💬</div>
                                        <div class="score-data-content">
                                            <div class="score-data-label">어휘 챌린지 평균</div>
                                            <div class="score-data-value">83.7<span class="score-unit">점</span></div>
                                            <div class="score-data-change up">
                                                <i class="fa-solid fa-arrow-up"></i> 지난 달 대비 +5점
                                            </div>
                                        </div>
                                    </div>
                                    <div class="score-data-card highlight">
                                        <div class="score-data-icon">🏆</div>
                                        <div class="score-data-content">
                                            <div class="score-data-label">최고 점수</div>
                                            <div class="score-data-value">98<span class="score-unit">점</span></div>
                                            <div class="score-data-subtitle">4월 3주차 독후 퀴즈</div>
                                        </div>
                                    </div>
                                    <div class="score-data-card">
                                        <div class="score-data-icon">📊</div>
                                        <div class="score-data-content">
                                            <div class="score-data-label">목표 달성률</div>
                                            <div class="score-data-value">92<span class="score-unit">%</span></div>
                                            <div class="score-data-subtitle">80점 이상 유지 목표</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 강점/약점 분석 -->
                        <div class="krs-analysis-section">
                            <h3 class="section-title">
                                <i class="fa-solid fa-microscope"></i>
                                학습 분석
                            </h3>
                            <div class="analysis-grid">
                                <div class="analysis-card strength">
                                    <div class="analysis-header">
                                        <i class="fa-solid fa-thumbs-up"></i>
                                        <span>강점 영역</span>
                                    </div>
                                    <ul class="analysis-list">
                                        <li>
                                            <span class="list-icon">📚</span>
                                            <span>메인도서 읽기 성실도가 매우 높아요</span>
                                        </li>
                                        <li>
                                            <span class="list-icon">🎯</span>
                                            <span>독후 퀴즈 정답률이 우수해요</span>
                                        </li>
                                        <li>
                                            <span class="list-icon">⭐</span>
                                            <span>추천도서 읽기도 꾸준히 하고 있어요</span>
                                        </li>
                                    </ul>
                                </div>

                                <div class="analysis-card improvement">
                                    <div class="analysis-header">
                                        <i class="fa-solid fa-chart-line"></i>
                                        <span>성장 기회</span>
                                    </div>
                                    <ul class="analysis-list">
                                        <li>
                                            <span class="list-icon">📖</span>
                                            <span>짝꿍책 2권만 더 읽으면 완료예요!</span>
                                        </li>
                                        <li>
                                            <span class="list-icon">🎮</span>
                                            <span>AI 어휘 챌린지를 조금 더 집중해보세요</span>
                                        </li>
                                        <li>
                                            <span class="list-icon">✅</span>
                                            <span>독후 퀴즈 2개만 더 풀면 완료!</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- 성장 지표 -->
                        <div class="krs-growth-section">
                            <h3 class="section-title">
                                <i class="fa-solid fa-seedling"></i>
                                6개월간 성장 지표
                            </h3>
                            <div class="growth-grid">
                                <div class="growth-card">
                                    <div class="growth-icon">📈</div>
                                    <div class="growth-value">+28%</div>
                                    <div class="growth-label">독서 속도 향상</div>
                                    <div class="growth-detail">75 → 96 WPM</div>
                                </div>
                                <div class="growth-card">
                                    <div class="growth-icon">🎯</div>
                                    <div class="growth-value">+15%</div>
                                    <div class="growth-label">퀴즈 정답률 상승</div>
                                    <div class="growth-detail">72% → 87%</div>
                                </div>
                                <div class="growth-card">
                                    <div class="growth-icon">📚</div>
                                    <div class="growth-value">+42권</div>
                                    <div class="growth-label">총 독서량 증가</div>
                                    <div class="growth-detail">월 평균 7권</div>
                                </div>
                                <div class="growth-card">
                                    <div class="growth-icon">⏱️</div>
                                    <div class="growth-value">142일</div>
                                    <div class="growth-label">총 학습일</div>
                                    <div class="growth-detail">78% 출석률</div>
                                </div>
                            </div>
                        </div>

                        <!-- 우수 활동 하이라이트 -->
                        <div class="krs-highlights-section">
                            <h3 class="section-title">
                                <i class="fa-solid fa-sparkles"></i>
                                우수 활동 하이라이트
                            </h3>
                            <div class="highlights-grid">
                                <div class="highlight-card">
                                    <div class="highlight-badge gold">
                                        <i class="fa-solid fa-trophy"></i>
                                    </div>
                                    <div class="highlight-content">
                                        <div class="highlight-title">21일 연속 학습 달성</div>
                                        <div class="highlight-date">2025년 12월</div>
                                        <div class="highlight-desc">최장 연속 학습 기록을 세웠어요!</div>
                                    </div>
                                </div>
                                <div class="highlight-card">
                                    <div class="highlight-badge blue">
                                        <i class="fa-solid fa-star"></i>
                                    </div>
                                    <div class="highlight-content">
                                        <div class="highlight-title">독후 퀴즈 만점 5회</div>
                                        <div class="highlight-date">총 16개 퀴즈 중</div>
                                        <div class="highlight-desc">완벽한 이해력을 보여주었어요!</div>
                                    </div>
                                </div>
                                <div class="highlight-card">
                                    <div class="highlight-badge green">
                                        <i class="fa-solid fa-book-open"></i>
                                    </div>
                                    <div class="highlight-content">
                                        <div class="highlight-title">한 달에 10권 독서</div>
                                        <div class="highlight-date">2026년 1월</div>
                                        <div class="highlight-desc">목표를 초과 달성했어요!</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- 내 책장 탭 콘텐츠 -->
                <div id="tab-bookshelf" class="tab-content hidden">
                    <!-- 카테고리 탭 -->
                    <div class="bookshelf-tabs">
                        <button class="bookshelf-tab active" data-shelf="reading" onclick="switchBookshelfTab('reading')">
                            📖 읽는 중 <span class="count" id="count-reading">3</span>
                        </button>
                        <button class="bookshelf-tab" data-shelf="completed" onclick="switchBookshelfTab('completed')">
                            ✅ 다 읽은 책 <span class="count" id="count-completed">45</span>
                        </button>
                        <button class="bookshelf-tab" data-shelf="favorites" onclick="switchBookshelfTab('favorites')">
                            💛 찜한 도서 <span class="count" id="count-favorites">0</span>
                        </button>
                    </div>

                    <!-- 책장 콘텐츠 -->
                    <div id="bookshelf-content">
                        <!-- JS로 렌더링 -->
                    </div>
                </div>
                <div id="tab-gallery" class="tab-content hidden">
                    <!-- 갤러리 서브탭 -->
                    <div class="gallery-subtabs">
                        <button class="gallery-subtab active" data-gtab="my" onclick="switchGalleryTab('my')">
                            <i class="fa-solid fa-palette"></i> 내 작품
                        </button>
                        <button class="gallery-subtab" data-gtab="friends" onclick="switchGalleryTab('friends')">
                            <i class="fa-solid fa-users"></i> 친구 작품
                        </button>
                        <button class="gallery-subtab" data-gtab="following" onclick="switchGalleryTab('following')">
                            <i class="fa-solid fa-heart"></i> 관심친구
                        </button>
                    </div>

                    <!-- 내 작품 탭 -->
                    <div id="gtab-my" class="gallery-content">
                        <!-- 필터 칩 -->
                        <div class="gallery-filters">
                            <button class="gallery-filter active" data-filter="all" onclick="filterGallery('all')">전체</button>
                            <button class="gallery-filter" data-filter="review" onclick="filterGallery('review')">✏️ 감상문</button>
                            <button class="gallery-filter" data-filter="audiobook" onclick="filterGallery('audiobook')">🎤 오디오북</button>
                            <button class="gallery-filter" data-filter="video" onclick="filterGallery('video')">🎬 동영상</button>
                            <button class="gallery-filter" data-filter="diary" onclick="filterGallery('diary')">📖 일기</button>
                        </div>
                        <!-- 정렬 -->
                        <div class="flex items-center justify-between mb-3">
                            <p class="text-xs text-gray-400">총 <strong class="text-gray-600">24</strong>개 작품</p>
                            <div class="flex items-center gap-2 text-xs">
                                <button class="gallery-sort active" data-sort="recent" onclick="sortGallery('recent')">최신순</button>
                                <span class="text-gray-300">|</span>
                                <button class="gallery-sort" data-sort="likes" onclick="sortGallery('likes')">좋아요순</button>
                            </div>
                        </div>
                        <!-- 그리드 -->
                        <div class="gallery-grid" id="my-gallery-grid">
                            <!-- JS로 렌더링 -->
                        </div>
                    </div>

                    <!-- 친구 작품 탭 -->
                    <div id="gtab-friends" class="gallery-content hidden">
                        <div class="text-xs text-gray-400 mb-3"><strong class="text-gray-600">관심친구 작품</strong>이 먼저 보여요</div>
                        <div class="gallery-grid" id="friends-gallery-feed">
                            <!-- JS로 렌더링 -->
                        </div>
                    </div>

                    <!-- 관심친구 탭 -->
                    <div id="gtab-following" class="gallery-content hidden">
                        <!-- 내가 관심+한 친구 -->
                        <div class="mb-5">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="text-sm font-bold text-gray-700">
                                    <i class="fa-solid fa-heart text-rose-400 mr-1"></i> 내가 관심+한 친구
                                </h4>
                                <span class="text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full font-bold">3명</span>
                            </div>
                            <div class="space-y-2" id="following-list">
                                <!-- JS로 렌더링 -->
                            </div>
                        </div>
                        <div class="border-t border-gray-100 my-4"></div>
                        <!-- 나를 관심+한 친구 -->
                        <div>
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="text-sm font-bold text-gray-700">
                                    <i class="fa-solid fa-star text-amber-400 mr-1"></i> 나를 관심+한 친구
                                </h4>
                                <span class="text-xs bg-amber-100 text-amber-600 px-2 py-0.5 rounded-full font-bold">5명</span>
                            </div>
                            <div class="space-y-2" id="followers-list">
                                <!-- JS로 렌더링 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

                <!-- 명예의전당 탭 콘텐츠 -->
                <div id="tab-fame" class="tab-content hidden">

                    <!-- 1. 북클럽 상장 -->
                    <div class="fame-section">
                        <div class="fame-section-header">
                            <div class="fame-section-title">
                                <i class="fa-solid fa-trophy"></i> 북클럽 상장
                                <button class="fame-help-btn">?</button>
                            </div>
                            <button class="fame-year-select">2025년 <i class="fa-solid fa-chevron-down"></i></button>
                        </div>
                        <div class="fame-scroll-wrap">
                            <div class="fame-scroll-track">
                                <!-- 1월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge blue">1월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 30</div>
                                    <p class="fame-award-name">독서왕</p>
                                </div>
                                <!-- 2월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">2월</span>
                                    <div class="fame-trophy">🥇<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge green">⭐ 20</div>
                                    <p class="fame-award-name">책사랑상</p>
                                </div>
                                <!-- 3월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge purple">3월</span>
                                    <div class="fame-trophy">🏅<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge blue">⭐ 15</div>
                                    <p class="fame-award-name">이야기탐험가상</p>
                                </div>
                                <!-- 4월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge yellow">4월</span>
                                    <div class="fame-trophy">🎖️<span class="sparkle">✨</span></div>
                                    <div class="fame-star-badge green">⭐ 10</div>
                                    <p class="fame-award-name">책벌레임문상</p>
                                </div>
                                <!-- 5월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge purple">5월</span>
                                    <div class="fame-trophy">🎗️<span class="sparkle">✨</span></div>
                                    <div class="fame-star-badge red">⭐ 5</div>
                                    <p class="fame-award-name">힘내자상</p>
                                </div>
                                <!-- 6월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge red">6월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 30</div>
                                    <p class="fame-award-name">독서왕</p>
                                </div>
                                <!-- 7월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge blue">7월</span>
                                    <div class="fame-trophy">🥇<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge green">⭐ 20</div>
                                    <p class="fame-award-name">책사랑상</p>
                                </div>
                                <!-- 8월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">8월</span>
                                    <div class="fame-trophy">🎗️<span class="sparkle">✨</span></div>
                                    <div class="fame-star-badge red">⭐ 5</div>
                                    <p class="fame-award-name">힘내자상</p>
                                </div>
                                <!-- 9월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">9월</span>
                                    <div class="fame-trophy">🏅<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge blue">⭐ 15</div>
                                    <p class="fame-award-name">이야기탐험가상</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. 스마트올 상장 -->
                    <div class="fame-section">
                        <div class="fame-section-header">
                            <div class="fame-section-title">
                                <i class="fa-solid fa-trophy"></i> 스마트올 상장
                                <button class="fame-help-btn">?</button>
                            </div>
                            <button class="fame-year-select">2025년 <i class="fa-solid fa-chevron-down"></i></button>
                        </div>
                        <div class="fame-scroll-wrap">
                            <div class="fame-scroll-track">
                                <!-- 1월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">1월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 150</div>
                                    <p class="fame-award-name">우수상</p>
                                </div>
                                <!-- 2월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">2월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 150</div>
                                    <p class="fame-award-name">우수상</p>
                                </div>
                                <!-- 3월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">3월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 150</div>
                                    <p class="fame-award-name">우수상</p>
                                </div>
                                <!-- 4월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge yellow">4월</span>
                                    <div class="fame-trophy">🥇<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge purple">⭐ 300</div>
                                    <p class="fame-award-name">최우수상</p>
                                </div>
                                <!-- 5월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge yellow">5월</span>
                                    <div class="fame-trophy">🥇<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge purple">⭐ 300</div>
                                    <p class="fame-award-name">최우수상</p>
                                </div>
                                <!-- 6월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge red">6월</span>
                                    <div class="fame-trophy">🏅<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge blue">⭐ 100</div>
                                    <p class="fame-award-name">자기주도학습상</p>
                                </div>
                                <!-- 7월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge red">7월</span>
                                    <div class="fame-trophy">🥇<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge purple">⭐ 300</div>
                                    <p class="fame-award-name">최우수상</p>
                                </div>
                                <!-- 8월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge red">8월</span>
                                    <div class="fame-trophy">🏆<span class="sparkle">✨</span><span class="sparkle">⭐</span></div>
                                    <div class="fame-star-badge gold">⭐ 150</div>
                                    <p class="fame-award-name">우수상</p>
                                </div>
                                <!-- 9월 -->
                                <div class="fame-award-card">
                                    <span class="fame-month-badge green">9월</span>
                                    <div class="fame-trophy">🎖️<span class="sparkle">✨</span></div>
                                    <div class="fame-star-badge green">⭐ 150</div>
                                    <p class="fame-award-name">힘내자상</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. 나의 배지 -->
                    <div class="fame-section">
                        <div class="fame-section-header">
                            <div class="fame-section-title">
                                <i class="fa-solid fa-trophy"></i> 나의 배지
                                <button class="fame-help-btn">?</button>
                            </div>
                            <button class="fame-team-link" onclick="switchToTeamChallenge()">팀 도전 계속하기</button>
                        </div>
                        <div class="fame-badge-grid">
                            <!-- 배지 1 - 하이라이트 핑크 -->
                            <div class="fame-badge-card highlight-pink">
                                <span class="fame-badge-icon">🎂</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#F59E0B;"></i> 벌써 1년</p>
                            </div>
                            <!-- 배지 2 - 하이라이트 그린 -->
                            <div class="fame-badge-card highlight-green">
                                <span class="fame-badge-icon">🏆</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#F59E0B;"></i> 올랭 1 등급 달성</p>
                            </div>
                            <!-- 배지 3 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🌤️</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 주말에도 살짝</p>
                                <p class="fame-badge-reward">⭐ 별 2개</p>
                            </div>
                            <!-- 배지 4 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🌱</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 이번달 첫 발자국</p>
                                <p class="fame-badge-reward">⭐ 별 2개</p>
                            </div>
                            <!-- 배지 5 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🎯</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> WSAT 모두 도전</p>
                                <p class="fame-badge-reward">⭐ 별 150개</p>
                            </div>
                            <!-- 배지 6 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">📖</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 필독서 10권 읽기</p>
                                <p class="fame-badge-reward">⭐ 별 5개</p>
                            </div>
                            <!-- 배지 7 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🌿</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 오랜만이야</p>
                                <p class="fame-badge-reward">⭐ 별 2개</p>
                            </div>
                            <!-- 배지 8 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🔥</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 10일 연속 출석</p>
                                <p class="fame-badge-reward">⭐ 별 120개</p>
                            </div>
                            <!-- 배지 9 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">📝</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> DKT 진단평가 응시하기</p>
                                <p class="fame-badge-reward">⭐ 별 5개</p>
                            </div>
                            <!-- 배지 10 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">👑</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 월간 챔피언</p>
                                <p class="fame-badge-reward">⭐ 별 150개</p>
                            </div>
                            <!-- 배지 11 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🎄</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 연휴 엔딩 출석</p>
                                <p class="fame-badge-reward">⭐ 별 2개</p>
                            </div>
                            <!-- 배지 12 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">💯</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 단원평가 연속 5회 100점</p>
                                <p class="fame-badge-reward">⭐ 별 180개</p>
                            </div>
                            <!-- 배지 13 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">📋</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 오답노트 정리왕</p>
                                <p class="fame-badge-reward">⭐ 별 100개</p>
                            </div>
                            <!-- 배지 14 -->
                            <div class="fame-badge-card">
                                <span class="fame-badge-icon">🔄</span>
                                <p class="fame-badge-name"><i class="fa-solid fa-certificate" style="color:#d1d5db;"></i> 복습왕</p>
                                <p class="fame-badge-reward">⭐ 별 110개</p>
                            </div>
                            <!-- 잠금 배지 1 -->
                            <div class="fame-badge-card locked">
                                <span class="fame-badge-icon">🔒</span>
                                <p class="fame-badge-name"></p>
                            </div>
                            <!-- 잠금 배지 2 -->
                            <div class="fame-badge-card locked">
                                <span class="fame-badge-icon">🔒</span>
                                <p class="fame-badge-name"></p>
                            </div>
                        </div>
                    </div>

                </div>

        </main>
    </div>

    <!-- 프로필 변경 모달 -->
    <div class="profile-modal" id="profile-modal">
        <div class="profile-modal-content">
            <h3 class="profile-modal-title">프로필 사진 변경</h3>
            <div class="profile-options">
                <div class="profile-option selected" data-emoji="😎">😎</div>
                <div class="profile-option" data-emoji="🦊">🦊</div>
                <div class="profile-option" data-emoji="🐱">🐱</div>
                <div class="profile-option" data-emoji="🐶">🐶</div>
                <div class="profile-option" data-emoji="🐰">🐰</div>
                <div class="profile-option" data-emoji="🐻">🐻</div>
                <div class="profile-option" data-emoji="🦁">🦁</div>
                <div class="profile-option" data-emoji="🐸">🐸</div>
                <div class="profile-option" data-emoji="🐼">🐼</div>
                <div class="profile-option" data-emoji="🐨">🐨</div>
                <div class="profile-option" data-emoji="🐯">🐯</div>
                <div class="profile-option" data-emoji="🦄">🦄</div>
            </div>
            <div>
                <button class="profile-modal-close" onclick="closeProfileModal()">취소</button>
                <button class="profile-modal-save" onclick="saveProfile()">저장</button>
            </div>
        </div>
    </div>

    <!-- Friend Work Detail Modal -->
    <div id="friend-work-modal" class="fixed inset-0 z-50 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-5" onclick="closeFriendWorkModal()">
        <div class="bg-white rounded-3xl shadow-2xl max-w-2xl w-full overflow-hidden anim-pop" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="p-4 border-b border-gray-100 flex items-center justify-between" id="friend-work-header">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br flex items-center justify-center text-2xl" id="friend-work-avatar"></div>
                    <div>
                        <div class="font-bold text-gray-800" id="friend-work-name"></div>
                        <div class="text-xs text-gray-400" id="friend-work-time"></div>
                    </div>
                </div>
                <button onclick="closeFriendWorkModal()" class="w-10 h-10 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-500 transition">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <!-- Content -->
            <div class="max-h-[70vh] overflow-y-auto">
                <!-- Image -->
                <div class="w-full aspect-video bg-gray-50 flex items-center justify-center" id="friend-work-image"></div>

                <!-- Info -->
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-xl font-bold text-gray-800" id="friend-work-title"></h3>
                        <span class="px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-600" id="friend-work-type"></span>
                    </div>
                    <p class="text-gray-600 mb-4" id="friend-work-desc"></p>
                </div>
            </div>

            <!-- Footer -->
            <div class="p-4 border-t border-gray-100 flex items-center gap-4">
                <button class="flex items-center gap-2 px-4 py-2 rounded-xl font-bold transition" id="friend-work-like-btn" onclick="toggleWorkLike()">
                    <i class="fa-regular fa-heart text-lg"></i>
                    <span id="friend-work-likes">0</span>
                </button>
            </div>
        </div>
    </div>

    <!-- My Review Detail Modal -->
    <div id="my-review-modal" class="fixed inset-0 z-50 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-5" onclick="closeMyReviewModal()">
        <div class="bg-white rounded-3xl shadow-2xl max-w-2xl w-full overflow-hidden anim-pop" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-2xl">
                        👤
                    </div>
                    <div>
                        <div class="font-bold text-gray-800">나</div>
                        <div class="text-xs text-gray-400" id="my-review-time"></div>
                    </div>
                </div>
                <button onclick="closeMyReviewModal()" class="w-10 h-10 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-500 transition">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <!-- Content -->
            <div class="max-h-[70vh] overflow-y-auto">
                <!-- Image -->
                <div class="w-full bg-gray-50 flex items-center justify-center p-8" id="my-review-image" style="min-height:400px;">
                    <!-- Drawing will be inserted here -->
                </div>

                <!-- Info -->
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-xl font-bold text-gray-800" id="my-review-book-title"></h3>
                        <span class="px-3 py-1 rounded-full text-xs font-bold" id="my-review-type-badge"></span>
                    </div>
                    <div class="flex items-center gap-2 text-sm text-gray-500">
                        <i class="fa-solid fa-heart text-red-400"></i>
                        <span id="my-review-likes">0</span>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="p-4 border-t border-gray-100 flex items-center gap-3">
                <button onclick="editMyReview()" class="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-bold bg-blue-50 text-blue-600 hover:bg-blue-100 transition">
                    <i class="fa-solid fa-pen"></i>
                    수정하기
                </button>
                <button onclick="deleteMyReview()" class="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-bold bg-red-50 text-red-500 hover:bg-red-100 transition">
                    <i class="fa-solid fa-trash"></i>
                    삭제하기
                </button>
            </div>
        </div>
    </div>

    <!-- Logout Modal Container -->
    <div id="logout-modal-container"></div>

    <!-- Scripts -->
    <script src="../js/common.js"></script>
    <script src="../js/sidebar.js"></script>

    <script>
        // === 탭 전환 ===
        const tabs = document.querySelectorAll('.mypage-tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // 활성 탭 변경
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // 콘텐츠 전환
                document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                document.getElementById('tab-' + tab.dataset.tab).classList.remove('hidden');

                // 갤러리 탭 진입 시 내 작품 렌더링 보장
                if (tab.dataset.tab === 'gallery') {
                    renderMyGallery();
                }
                // 내 책장 탭 진입 시 책장 렌더링 보장
                if (tab.dataset.tab === 'bookshelf') {
                    renderBookshelf();
                }
            });
        });

        // === 프로필 모달 ===
        let selectedEmoji = '😎';

        function openProfileModal() {
            document.getElementById('profile-modal').classList.add('show');
        }

        function closeProfileModal() {
            document.getElementById('profile-modal').classList.remove('show');
        }

        // 프로필 옵션 선택
        document.querySelectorAll('.profile-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('.profile-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
                selectedEmoji = opt.dataset.emoji;
            });
        });

        function saveProfile() {
            document.getElementById('profile-emoji').textContent = selectedEmoji;
            closeProfileModal();
        }

        // 모달 바깥 클릭 시 닫기
        document.getElementById('profile-modal').addEventListener('click', (e) => {
            if (e.target.id === 'profile-modal') {
                closeProfileModal();
            }
        });

        // === 출석 달력 렌더링 ===
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            const year = 2026;
            const month = 2; // 2월

            // 2026년 2월 1일은 일요일
            const firstDay = new Date(year, month - 1, 1).getDay();
            const daysInMonth = new Date(year, month, 0).getDate();
            const today = 4; // 오늘이 4일

            // 출석한 날 (예시)
            const stampedDays = [1, 2, 3]; // 1, 2, 3일 출석

            let html = '';

            // 빈 칸 (월 시작 전)
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="calendar-day empty"></div>';
            }

            // 날짜
            for (let d = 1; d <= daysInMonth; d++) {
                let classes = 'calendar-day';
                let content = `<span class="day-num">${d}</span>`;

                if (stampedDays.includes(d)) {
                    classes += ' stamped';
                    content = `<span class="stamp-icon">🔥</span><span class="day-num">${d}</span>`;
                } else if (d === today) {
                    classes += ' today';
                } else if (d > today) {
                    classes += ' future';
                }

                html += `<div class="${classes}">${content}</div>`;
            }

            grid.innerHTML = html;
        }

        // === 리포트 탭 전환 ===
        let krsChartsInitialized = false;
        let monthlyReadingChart, activityCompletionChart, scoreTrendChart;

        function switchReportType(type) {
            // 버튼 활성화 상태 변경
            document.querySelectorAll('.report-toggle-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.report === type);
            });
            // 콘텐츠 전환
            document.querySelectorAll('.report-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById('report-' + type).classList.remove('hidden');

            // KRS 리포트 선택 시 차트 초기화
            if (type === 'krs' && !krsChartsInitialized) {
                setTimeout(() => {
                    initKRSCharts();
                    krsChartsInitialized = true;
                }, 100);
            }
        }

        // === KRS 레벨 리포트 차트 초기화 ===
        function initKRSCharts() {
            initMonthlyReadingChart();
            initActivityCompletionChart();
            initScoreTrendChart();
        }

        // 월별 독서량 추이 차트
        function initMonthlyReadingChart() {
            const ctx = document.getElementById('monthlyReadingChart');
            if (!ctx) return;

            // 기존 차트가 있으면 파괴
            if (monthlyReadingChart) {
                monthlyReadingChart.destroy();
            }

            monthlyReadingChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1월', '2월', '3월', '4월', '5월', '6월'],
                    datasets: [
                        {
                            label: 'KRS 메인도서',
                            data: [2, 3, 4, 5, 4, 4],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        },
                        {
                            label: '교과서 짝꿍책',
                            data: [2, 3, 3, 4, 4, 4],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        },
                        {
                            label: 'KRS 추천도서',
                            data: [5, 6, 8, 10, 12, 8],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 13,
                                    weight: '600'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '권';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 2,
                                callback: function(value) {
                                    return value + '권';
                                },
                                font: {
                                    size: 12
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        // 활동 완료율 차트
        function initActivityCompletionChart() {
            const ctx = document.getElementById('activityCompletionChart');
            if (!ctx) return;

            // 기존 차트가 있으면 파괴
            if (activityCompletionChart) {
                activityCompletionChart.destroy();
            }

            activityCompletionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['KRS 메인도서', '교과서 짝꿍책', '독후 퀴즈', 'AI 어휘 챌린지'],
                    datasets: [{
                        data: [91.7, 83.3, 88.9, 85.7], // 22/24, 20/24, 16/18, 12/14
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#8b5cf6'
                        ],
                        borderWidth: 3,
                        borderColor: '#ffffff',
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false  // 커스텀 범례 사용
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.toFixed(1) + '%';
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
        }

        // 점수 추이 차트
        function initScoreTrendChart() {
            const ctx = document.getElementById('scoreTrendChart');
            if (!ctx) return;

            // 기존 차트가 있으면 파괴
            if (scoreTrendChart) {
                scoreTrendChart.destroy();
            }

            scoreTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1월', '2월', '3월', '4월', '5월', '6월'],
                    datasets: [
                        {
                            label: '독후 퀴즈 평균 점수',
                            data: [82, 85, 88, 90, 92, 91],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2
                        },
                        {
                            label: 'AI 어휘 챌린지 평균 점수',
                            data: [78, 80, 83, 86, 88, 87],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.2)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 13,
                                    weight: '600'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '점';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 70,
                            max: 100,
                            ticks: {
                                stepSize: 5,
                                callback: function(value) {
                                    return value + '점';
                                },
                                font: {
                                    size: 12
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        // === 내 책장 탭 전환 ===
        let currentBookshelfTab = 'reading';

        function switchBookshelfTab(tab) {
            currentBookshelfTab = tab;
            // 버튼 활성화 상태 변경
            document.querySelectorAll('.bookshelf-tab').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.shelf === tab);
            });
            renderBookshelf();
        }

        // 책장 데이터 (읽는 중, 다 읽은 책은 샘플 데이터)
        const readingBooks = [
            { id: 'book1', title: '오즈의 마법사', genre: '세계명작', bg: 'bg-gradient-to-br from-emerald-100 to-teal-200', emoji: '🧙', progress: 65, favorited: true },
            { id: 'book2', title: '이상한 나라의 앨리스', genre: '세계명작', bg: 'bg-gradient-to-br from-purple-100 to-pink-200', emoji: '🐰', progress: 30, favorited: false },
            { id: 'book3', title: '피터팬', genre: '세계명작', bg: 'bg-gradient-to-br from-blue-100 to-cyan-200', emoji: '🧚', progress: 80, favorited: false }
        ];

        const completedBooks = [
            { id: 'book4', title: '백설공주', genre: '세계명작', bg: 'bg-gradient-to-br from-red-100 to-rose-200', emoji: '🍎' },
            { id: 'book5', title: '신데렐라', genre: '세계명작', bg: 'bg-gradient-to-br from-blue-100 to-indigo-200', emoji: '👠' },
            { id: 'book6', title: '인어공주', genre: '세계명작', bg: 'bg-gradient-to-br from-teal-100 to-cyan-200', emoji: '🧜' },
            { id: 'book7', title: '흥부와 놀부', genre: '전래동화', bg: 'bg-gradient-to-br from-amber-100 to-yellow-200', emoji: '🐦' },
            { id: 'book8', title: '콩쥐 팥쥐', genre: '전래동화', bg: 'bg-gradient-to-br from-pink-100 to-rose-200', emoji: '🥿' },
            { id: 'book9', title: '해와 달이 된 오누이', genre: '전래동화', bg: 'bg-gradient-to-br from-orange-100 to-red-200', emoji: '🌙' }
        ];

        // 우리 아이 책장 (오프라인 도서)
        const offlineBooks = [
            { id: 'off1', title: '그리스 로마 신화 1', genre: '오프라인', bg: 'bg-gradient-to-br from-amber-100 to-orange-200', emoji: '⚡' },
            { id: 'off2', title: '그리스 로마 신화 2', genre: '오프라인', bg: 'bg-gradient-to-br from-amber-100 to-orange-200', emoji: '🔱' },
            { id: 'off3', title: '마법천자문 1', genre: '오프라인', bg: 'bg-gradient-to-br from-red-100 to-pink-200', emoji: '🐉' },
            { id: 'off4', title: '마법천자문 2', genre: '오프라인', bg: 'bg-gradient-to-br from-red-100 to-pink-200', emoji: '🔥' },
            { id: 'off5', title: '설민석의 한국사 대모험 1', genre: '오프라인', bg: 'bg-gradient-to-br from-blue-100 to-indigo-200', emoji: '🏯' },
            { id: 'off6', title: '설민석의 한국사 대모험 2', genre: '오프라인', bg: 'bg-gradient-to-br from-blue-100 to-indigo-200', emoji: '⚔️' },
            { id: 'off7', title: '흔한남매 1', genre: '오프라인', bg: 'bg-gradient-to-br from-yellow-100 to-lime-200', emoji: '😂' },
            { id: 'off8', title: '흔한남매 2', genre: '오프라인', bg: 'bg-gradient-to-br from-yellow-100 to-lime-200', emoji: '🤣' },
            { id: 'off9', title: '쿠키런 킹덤 1', genre: '오프라인', bg: 'bg-gradient-to-br from-purple-100 to-violet-200', emoji: '🍪' },
            { id: 'off10', title: '쿠키런 킹덤 2', genre: '오프라인', bg: 'bg-gradient-to-br from-purple-100 to-violet-200', emoji: '👑' },
            { id: 'off11', title: '코믹 메이플스토리 1', genre: '오프라인', bg: 'bg-gradient-to-br from-green-100 to-emerald-200', emoji: '🍁' },
            { id: 'off12', title: '코믹 메이플스토리 2', genre: '오프라인', bg: 'bg-gradient-to-br from-green-100 to-emerald-200', emoji: '🎮' }
        ];

        function renderBookshelf() {
            const container = document.getElementById('bookshelf-content');
            let books = [];
            let emptyMsg = '';
            let emptyIcon = '';

            switch (currentBookshelfTab) {
                case 'reading':
                    books = readingBooks;
                    emptyIcon = '📖';
                    emptyMsg = '현재 읽고 있는 책이 없어요.<br>라이브러리에서 책을 골라보세요!';
                    break;
                case 'completed':
                    books = completedBooks;
                    emptyIcon = '✅';
                    emptyMsg = '아직 다 읽은 책이 없어요.<br>첫 번째 책을 완독해보세요!';
                    break;
                case 'favorites':
                    // sessionStorage에서 찜한 도서 가져오기 (book-library.html과 동기화)
                    books = JSON.parse(sessionStorage.getItem('favoriteBooks') || '[]');
                    emptyIcon = '💛';
                    emptyMsg = '찜한 도서가 없어요.<br>라이브러리에서 마음에 드는 도서를 찜해보세요!';
                    break;
                case 'offline':
                    books = offlineBooks;
                    emptyIcon = '📚';
                    emptyMsg = '등록된 오프라인 도서가 없어요.';
                    break;
            }

            // 카운트 업데이트
            document.getElementById('count-favorites').textContent = JSON.parse(sessionStorage.getItem('favoriteBooks') || '[]').length;

            if (books.length === 0) {
                container.innerHTML = `
                    <div class="bookshelf-grid">
                        <div class="bookshelf-empty">
                            <div class="bookshelf-empty-icon">${emptyIcon}</div>
                            <div class="bookshelf-empty-text">${emptyMsg}</div>
                            <a href="book-library.html" class="bookshelf-go-library">
                                <i class="fa-solid fa-layer-group"></i> 라이브러리 가기
                            </a>
                        </div>
                    </div>
                `;
                return;
            }

            const bookCards = books.map(book => {
                const progressBar = book.progress ? `
                    <div class="bookshelf-book-progress">
                        <div class="bookshelf-book-progress-fill" style="width: ${book.progress}%;"></div>
                    </div>
                ` : '';

                // 진행률 배지 + 찜 버튼 (우측 상단)
                const badgeHtml = book.progress ? `<div class="bookshelf-book-badge">${book.progress}%</div>` : '';
                const favActive = book.favorited ? ' active' : '';
                const favIconClass = book.favorited ? 'fa-solid' : 'fa-regular';
                const topbar = `
                    <div class="bookshelf-book-topbar">
                        ${badgeHtml}
                        <button class="bookshelf-fav-btn${favActive}" onclick="toggleShelfFav(event, '${book.id}')">
                            <i class="${favIconClass} fa-heart"></i>
                        </button>
                    </div>
                `;

                // bg 클래스 또는 기본 색상 처리
                const bgClass = book.bg || 'bg-gradient-to-br from-gray-100 to-gray-200';
                const emoji = book.emoji || '📕';

                // 감상문 쓰기 버튼 (읽는 중, 다 읽은 책에만 표시)
                const writeReportBtn = (currentBookshelfTab === 'reading' || currentBookshelfTab === 'completed') ? `
                    <button class="bookshelf-write-btn" onclick="writeReportFromShelf(event, '${book.id}', '${book.title.replace(/'/g, "\\'")}', '${book.genre || ''}')">
                        ✏️ 감상문 쓰기
                    </button>
                ` : '';

                return `
                    <div class="bookshelf-book" onclick="openBookFromShelf('${book.id}', '${(book.genre || '').replace(/'/g, "\\'")}')">
                        <div class="bookshelf-book-cover ${bgClass}">
                            ${emoji}
                            ${progressBar}
                            ${topbar}
                        </div>
                        <div class="bookshelf-book-info">
                            <div class="bookshelf-book-title">${book.title}</div>
                            <div class="bookshelf-book-series">${book.genre || ''}</div>
                            ${writeReportBtn}
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `<div class="bookshelf-grid">${bookCards}</div>`;
        }

        function openBookFromShelf(bookId, genre) {
            // book-viewer로 이동하거나 책 상세 페이지로 이동
            console.log('책 열기:', bookId, genre);
            // 필요시 window.location.href = 'book-viewer.html?id=' + bookId;
        }

        function writeReportFromShelf(event, bookId, bookTitle, genre) {
            event.stopPropagation(); // 부모 클릭 이벤트 방지

            // 책 정보를 sessionStorage에 저장
            const bookData = {
                id: bookId,
                title: bookTitle,
                genre: genre,
                source: 'mypage'
            };
            sessionStorage.setItem('currentBook', JSON.stringify(bookData));
            sessionStorage.setItem('referrer', 'mypage.html');

            // 감상문 작성 페이지로 이동
            window.location.href = 'review-writer.html';
        }

        function toggleShelfFav(event, bookId) {
            event.stopPropagation();
            // 모든 책 목록에서 해당 도서 찾기
            const allBooks = [...readingBooks, ...completedBooks, ...offlineBooks];
            const book = allBooks.find(b => b.id === bookId);
            if (book) {
                book.favorited = !book.favorited;
            }
            renderBookshelf();
        }

        // === 갤러리 데이터 ===
        const myWorks = [
            { id: 1, type: 'video', title: '마법사의 물약 리텔링', likes: 24, date: '20260125', bg: 'bg-gradient-to-br from-pink-200 to-rose-300', emoji: '🎬', typeLabel: '동영상', typeColor: 'text-pink-600' },
            { id: 2, type: 'review', title: '숲속 친구들 독후감', likes: 18, date: '20260122', bg: 'bg-gradient-to-br from-green-200 to-emerald-300', emoji: '✏️', typeLabel: '감상문', typeColor: 'text-green-600' },
            { id: 3, type: 'audiobook', title: '우주 탐험대 낭독', likes: 31, date: '20260118', bg: 'bg-gradient-to-br from-blue-200 to-indigo-300', emoji: '🎤', typeLabel: '오디오북', typeColor: 'text-blue-600' },
            { id: 4, type: 'diary', title: '공주와 용 일기', likes: 12, date: '20260115', bg: 'bg-gradient-to-br from-purple-200 to-violet-300', emoji: '📖', typeLabel: '일기', typeColor: 'text-purple-600' },
            { id: 5, type: 'video', title: '하늘을 나는 코끼리', likes: 15, date: '20260108', bg: 'bg-gradient-to-br from-cyan-200 to-teal-300', emoji: '🎬', typeLabel: '동영상', typeColor: 'text-cyan-600' },
            { id: 6, type: 'review', title: '공룡에게 보내는 편지', likes: 22, date: '20260105', bg: 'bg-gradient-to-br from-rose-200 to-pink-300', emoji: '✏️', typeLabel: '감상문', typeColor: 'text-rose-600' },
            { id: 7, type: 'audiobook', title: '겨울왕국 낭독', likes: 27, date: '20251228', bg: 'bg-gradient-to-br from-indigo-200 to-blue-300', emoji: '🎤', typeLabel: '오디오북', typeColor: 'text-indigo-600' },
            { id: 8, type: 'diary', title: '크리스마스 일기', likes: 14, date: '20251225', bg: 'bg-gradient-to-br from-violet-200 to-purple-300', emoji: '📖', typeLabel: '일기', typeColor: 'text-violet-600' },
            { id: 9, type: 'video', title: '바다 속 친구들', likes: 9, date: '20251220', bg: 'bg-gradient-to-br from-amber-200 to-orange-300', emoji: '🎬', typeLabel: '동영상', typeColor: 'text-amber-600' }
        ];

        const friendsWorks = [
            { id: 1, name: '수아', avatar: '🦊', avatarBg: 'from-pink-400 to-rose-500', class: '3학년 2반', time: '1시간 전', type: 'video', typeLabel: '동영상', title: '마법의 숲 이야기 리텔링', desc: '《마법의 숲》을 읽고 만든 영상이에요!', likes: 42, comments: 5, liked: true, following: true, bg: 'bg-gradient-to-br from-pink-200 to-rose-300', emoji: '🎬' },
            { id: 2, name: '민준', avatar: '🐻', avatarBg: 'from-blue-400 to-indigo-500', class: '3학년 1반', time: '3시간 전', type: 'review', typeLabel: '감상문', title: '아기 공룡 두리 독후감', desc: '공룡이 친구를 찾는 이야기가 재미있었어요', likes: 35, comments: 3, liked: false, following: false, bg: 'bg-gradient-to-br from-green-200 to-emerald-300', emoji: '✏️' },
            { id: 3, name: '서연', avatar: '🐰', avatarBg: 'from-purple-400 to-violet-500', class: '3학년 2반', time: '5시간 전', type: 'audiobook', typeLabel: '오디오북', title: '별나라 친구들 낭독', desc: '목소리 연기도 했어요! 들어보세요~', likes: 28, comments: 7, liked: false, following: false, bg: 'bg-gradient-to-br from-blue-200 to-indigo-300', emoji: '🎤' },
            { id: 4, name: '하윤', avatar: '🐱', avatarBg: 'from-amber-400 to-orange-500', class: '3학년 3반', time: '어제', type: 'photo', typeLabel: '사진', title: '우리 강아지와 책 읽기', desc: '강아지도 같이 읽었어요 🐶', likes: 56, comments: 12, liked: true, following: true, bg: 'bg-gradient-to-br from-amber-200 to-orange-300', emoji: '📷' }
        ];

        const followingFriends = [
            { name: '수아', avatar: '🦊', avatarBg: 'from-pink-400 to-rose-500', class: '3학년 2반', works: 32, lastActive: '1월 25일', tags: ['동영상 12', '감상문 8'] },
            { name: '하윤', avatar: '🐱', avatarBg: 'from-amber-400 to-orange-500', class: '3학년 3반', works: 28, lastActive: '어제', tags: ['사진 15', '오디오북 6'] },
            { name: '도윤', avatar: '🐸', avatarBg: 'from-emerald-400 to-green-500', class: '3학년 2반', works: 19, lastActive: '1월 20일', tags: ['감상문 10', '학습 5'] }
        ];

        const followerFriends = [
            { name: '수아', avatar: '🦊', avatarBg: 'from-pink-400 to-rose-500', class: '3학년 2반', works: 32, following: true },
            { name: '민준', avatar: '🐻', avatarBg: 'from-blue-400 to-indigo-500', class: '3학년 1반', works: 15, following: false },
            { name: '서연', avatar: '🐰', avatarBg: 'from-purple-400 to-violet-500', class: '3학년 2반', works: 21, following: false },
            { name: '시우', avatar: '🐢', avatarBg: 'from-cyan-400 to-teal-500', class: '3학년 1반', works: 8, following: false },
            { name: '하윤', avatar: '🐱', avatarBg: 'from-amber-400 to-orange-500', class: '3학년 3반', works: 28, following: true }
        ];

        let galleryFilter = 'all';
        let gallerySort = 'recent';

        // === 감상문 데이터 및 설정 ===
        const REVIEW_STORAGE_KEY = 'bookclub3_reviews_v1';
        const REVIEW_TYPES = {
            feeling: {icon:'💭', label:'내 마음', class:''},
            character: {icon:'🎭', label:'주인공', class:'purple'},
            question: {icon:'❓', label:'궁금해', class:'amber'},
            doodle: {icon:'🎨', label:'자유 그림', class:'pink'},
        };
        let allReviews = [];

        // === 독서로 키재기 마일스톤 ===
        const USER_CURRENT_STAGE = 6; // 사용자 현재 단계 (세종대왕)
        let currentMilestoneStage = 0;

        const milestoneData = [
            {
                stage: 1,
                books: 100,
                height: '1m',
                emoji: '🧸',
                title: '대형 곰인형',
                description: '나랑 덩치가 비슷한 곰인형만큼 읽었어요!',
                heightPercent: 10
            },
            {
                stage: 2,
                books: 200,
                height: '2m',
                emoji: '🧊',
                title: '냉장고',
                description: '우리 집에서 제일 큰 냉장고보다 높아졌네?',
                heightPercent: 20
            },
            {
                stage: 3,
                books: 300,
                height: '3m',
                emoji: '🏀',
                title: '농구골대',
                description: '점프해도 닿지 않는 농구골대까지 쑥!',
                heightPercent: 30
            },
            {
                stage: 4,
                books: 400,
                height: '4m',
                emoji: '🐘',
                title: '코끼리',
                description: '세상에서 가장 큰 동물인 코끼리 키만큼!',
                heightPercent: 40
            },
            {
                stage: 5,
                books: 550,
                height: '5.5m',
                emoji: '🦒',
                title: '기린',
                description: '목이 긴 기린의 머리 위가 보여요.',
                heightPercent: 50
            },
            {
                stage: 6,
                books: 1100,
                height: '11m',
                emoji: '👑',
                title: '세종대왕 동상',
                description: '광화문의 세종대왕님과 하이파이브!',
                heightPercent: 60
            },
            {
                stage: 7,
                books: 9300,
                height: '93m',
                emoji: '🗽',
                title: '자유의 여신상',
                description: '1만 권 임박! 바다 건너 뉴욕까지 왔어요.',
                heightPercent: 70
            },
            {
                stage: 8,
                books: 13800,
                height: '138m',
                emoji: '🏜️',
                title: '피라미드',
                description: '고대 이집트의 거대한 성벽을 정복!',
                heightPercent: 80
            },
            {
                stage: 9,
                books: 17000,
                height: '170m',
                emoji: '🗼',
                title: '에펠탑 (전망대)',
                description: '파리 에펠탑 위에서 구름을 만져봐요.',
                heightPercent: 90
            },
            {
                stage: 10,
                books: 20000,
                height: '200m',
                emoji: '🏯',
                title: '남산 서울타워',
                description: '2만 권 완독! 서울에서 가장 높은 주인공!',
                heightPercent: 100
            }
        ];

        // Get milestone status based on user's current stage
        function getMilestoneStatus(stageNumber) {
            if (stageNumber < USER_CURRENT_STAGE) {
                return 'completed'; // 획득 완료
            } else if (stageNumber === USER_CURRENT_STAGE) {
                return 'current'; // 현재단계
            } else {
                return 'locked'; // 잠김
            }
        }

        function openMilestoneModal() {
            const modal = document.getElementById('milestone-modal');
            if (!modal) return;

            // Initialize carousel if not already done
            if (!modal.querySelector('.milestone-stage')) {
                initializeMilestoneCarousel();
            }

            modal.classList.add('show');
            currentMilestoneStage = 0;
            updateMilestoneDisplay();

            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        function closeMilestoneModal() {
            const modal = document.getElementById('milestone-modal');
            if (!modal) return;

            modal.classList.remove('show');
            document.body.style.overflow = '';
        }

        function initializeMilestoneCarousel() {
            const carousel = document.querySelector('.milestone-carousel');
            if (!carousel) return;

            let html = '';
            milestoneData.forEach((milestone, index) => {
                const status = getMilestoneStatus(milestone.stage);
                const statusText = status === 'completed' ? '✅ 획득 완료' :
                                   status === 'current' ? '⭐ 현재단계' :
                                   '🔒 잠김';
                const statusClass = `milestone-stage-${status}`;

                // Calculate fill percentage based on status
                let fillPercent = milestone.heightPercent;
                if (status === 'completed') {
                    // Already achieved stages: 100% fill
                    fillPercent = 100;
                } else if (status === 'current') {
                    // Current stage (세종대왕): 20% fill
                    fillPercent = 20;
                } else if (status === 'locked') {
                    // Future stages: decreasing fill based on distance from current
                    const stagesAfterCurrent = milestone.stage - USER_CURRENT_STAGE;
                    if (stagesAfterCurrent === 1) {
                        fillPercent = 20; // First stage after current
                    } else if (stagesAfterCurrent === 2) {
                        fillPercent = 5;  // Second stage after current
                    } else if (stagesAfterCurrent === 3) {
                        fillPercent = 1;  // Third stage after current
                    } else {
                        fillPercent = 0;  // Fourth+ stages after current
                    }
                }

                html += `
                    <div class="milestone-stage ${index === 0 ? 'active-stage' : ''} ${statusClass}" data-stage="${milestone.stage}">
                        <div class="milestone-status-badge">${statusText}</div>
                        <div class="milestone-stage-visual">
                            <div class="milestone-height-bar" style="height: ${fillPercent}%;"></div>
                            <div class="milestone-emoji">${milestone.emoji}</div>
                        </div>
                        <div class="milestone-stage-info">
                            <div class="milestone-stage-number">Stage ${milestone.stage}</div>
                            <div class="milestone-stage-title">${milestone.title}</div>
                            <div class="milestone-stage-stats">
                                <span class="milestone-books">${milestone.books.toLocaleString()}권</span>
                                <span class="milestone-height">${milestone.height}</span>
                            </div>
                            <p class="milestone-stage-desc">${milestone.description}</p>
                        </div>
                    </div>
                `;
            });

            carousel.innerHTML = html;

            // Initialize indicators
            const indicators = document.querySelector('.milestone-indicators');
            if (indicators) {
                let dotsHtml = '';
                milestoneData.forEach((_, index) => {
                    const status = getMilestoneStatus(index + 1);
                    const dotStatusClass = status === 'completed' ? 'dot-completed' :
                                          status === 'current' ? 'dot-current' :
                                          'dot-future';
                    dotsHtml += `<div class="milestone-dot ${index === 0 ? 'active' : ''} ${dotStatusClass}" onclick="goToMilestone(${index})"></div>`;
                });
                indicators.innerHTML = dotsHtml;
            }
        }

        function goToMilestone(index) {
            if (index < 0 || index >= milestoneData.length) return;
            currentMilestoneStage = index;
            updateMilestoneDisplay();
        }

        function nextMilestone() {
            if (currentMilestoneStage < milestoneData.length - 1) {
                currentMilestoneStage++;
                updateMilestoneDisplay();
            }
        }

        function prevMilestone() {
            if (currentMilestoneStage > 0) {
                currentMilestoneStage--;
                updateMilestoneDisplay();
            }
        }

        function updateMilestoneDisplay() {
            // Update stage cards
            const stages = document.querySelectorAll('.milestone-stage');
            stages.forEach((stage, index) => {
                if (index === currentMilestoneStage) {
                    stage.classList.add('active-stage');
                } else {
                    stage.classList.remove('active-stage');
                }
            });

            // Update dots with status colors
            const dots = document.querySelectorAll('.milestone-dot');
            dots.forEach((dot, index) => {
                const stageNumber = index + 1; // stages are 1-indexed
                const status = getMilestoneStatus(stageNumber);

                // Remove all status classes
                dot.classList.remove('dot-completed', 'dot-current', 'dot-future');

                // Add appropriate status class
                if (status === 'completed') {
                    dot.classList.add('dot-completed');
                } else if (status === 'current') {
                    dot.classList.add('dot-current');
                } else {
                    dot.classList.add('dot-future');
                }

                // Update active state
                if (index === currentMilestoneStage) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            // Update navigation buttons
            const prevBtn = document.querySelector('.milestone-prev');
            const nextBtn = document.querySelector('.milestone-next');

            if (prevBtn) {
                prevBtn.disabled = currentMilestoneStage === 0;
            }

            if (nextBtn) {
                nextBtn.disabled = currentMilestoneStage === milestoneData.length - 1;
            }
        }

        // Close modal on outside click and keyboard events
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('milestone-modal');
            if (modal) {
                // Close on outside click
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeMilestoneModal();
                    }
                });

                // Close on ESC key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && modal.classList.contains('show')) {
                        closeMilestoneModal();
                    }
                });

                // Arrow key navigation
                document.addEventListener('keydown', function(e) {
                    if (!modal.classList.contains('show')) return;

                    if (e.key === 'ArrowLeft') {
                        prevMilestone();
                    } else if (e.key === 'ArrowRight') {
                        nextMilestone();
                    }
                });
            }
        });

        // === KRS 승급 도전 시스템 ===
        const KRS_DATA = {
            currentLevel: 'K2-1',
            targetLevel: 'K2-2',
            currentScore: 420,
            requiredScore: 600,
            maxScore: 1000,
            completedWeeks: 16,
            totalWeeks: 24,
            tiers: [
                { name: '승급 가능', score: 600, icon: '✅', class: 'baseline', reward: null },
                { name: '브론즈', score: 700, icon: '🥉', class: 'bronze', reward: 50 },
                { name: '실버', score: 800, icon: '🥈', class: 'silver', reward: 100 },
                { name: '골드', score: 900, icon: '🥇', class: 'gold', reward: 200 },
                { name: '다이아몬드', score: 900, icon: '💎', class: 'diamond', reward: 500 }
            ]
        };

        function updateKRSDisplay() {
            // Update score
            const scoreElement = document.querySelector('.krs-current-score');
            if (scoreElement) {
                scoreElement.innerHTML = `${KRS_DATA.currentScore}<span class="krs-score-unit">점</span>`;
            }

            // Update progress bar
            const progressFill = document.querySelector('.krs-progress-fill');
            if (progressFill) {
                const percentage = (KRS_DATA.currentScore / KRS_DATA.maxScore) * 100;
                progressFill.style.width = `${percentage}%`;
                const label = progressFill.querySelector('.krs-progress-label');
                if (label) {
                    label.textContent = `${Math.round(percentage)}%`;
                }
            }

            // Update threshold position
            const threshold = document.querySelector('.krs-progress-threshold');
            if (threshold) {
                const thresholdPercentage = (KRS_DATA.requiredScore / KRS_DATA.maxScore) * 100;
                threshold.style.left = `${thresholdPercentage}%`;
            }

            // Update remaining score
            const remaining = KRS_DATA.requiredScore - KRS_DATA.currentScore;
            const statusElement = document.querySelector('.krs-level-status');
            if (statusElement) {
                if (remaining > 0) {
                    statusElement.innerHTML = `승급까지 <strong>${remaining}점</strong> 남았어요`;
                } else {
                    statusElement.innerHTML = `축하합니다! <strong>승급 가능</strong>합니다 🎉`;
                }
            }

            // Update checklist
            const checklistItems = document.querySelectorAll('.krs-checklist-item');
            if (checklistItems[0]) {
                const scoreCheck = checklistItems[0].querySelector('i');
                const scoreStatus = checklistItems[0].querySelector('.krs-checklist-status');
                if (KRS_DATA.currentScore >= KRS_DATA.requiredScore) {
                    scoreCheck.className = 'fa-solid fa-check-circle';
                    scoreCheck.style.color = '#22c55e';
                    scoreStatus.classList.remove('pending');
                    scoreStatus.style.color = '#22c55e';
                } else {
                    scoreCheck.className = 'fa-regular fa-circle';
                    scoreCheck.style.color = '#d1d5db';
                    scoreStatus.classList.add('pending');
                }
                scoreStatus.textContent = `${KRS_DATA.currentScore} / ${KRS_DATA.requiredScore}`;
            }

            if (checklistItems[1]) {
                const weeksCheck = checklistItems[1].querySelector('i');
                const weeksStatus = checklistItems[1].querySelector('.krs-checklist-status');
                if (KRS_DATA.completedWeeks >= KRS_DATA.totalWeeks) {
                    weeksCheck.className = 'fa-solid fa-check-circle';
                    weeksCheck.style.color = '#22c55e';
                    weeksStatus.style.color = '#22c55e';
                } else {
                    weeksCheck.className = 'fa-regular fa-circle';
                    weeksCheck.style.color = '#d1d5db';
                }
                weeksStatus.textContent = `${KRS_DATA.completedWeeks} / ${KRS_DATA.totalWeeks}주`;
            }

            // Update tier cards
            const tierCards = document.querySelectorAll('.krs-tier-card');
            tierCards.forEach((card, index) => {
                const tier = KRS_DATA.tiers[index];
                if (!tier) return;

                // Unlock/lock based on current score
                if (KRS_DATA.currentScore >= tier.score) {
                    card.classList.remove('locked');
                } else {
                    card.classList.add('locked');
                }
            });
        }

        // Initialize KRS display when tab is opened
        document.addEventListener('DOMContentLoaded', function() {
            updateKRSDisplay();
        });

        // === 올도전 탭 전환 ===
        function switchChallengeTab(tab) {
            document.querySelectorAll('.challenge-subtab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.challenge-subtab[data-ctab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.challenge-content').forEach(c => c.classList.add('hidden'));
            document.getElementById('ctab-' + tab).classList.remove('hidden');
        }

        // === 팀 도전: 미션 예약 ===
        // === 명예의전당 → 팀 도전 탭으로 이동 ===
        function switchToTeamChallenge() {
            // 올도전 탭 활성화
            const tabs = document.querySelectorAll('.mypage-tab');
            tabs.forEach(t => t.classList.remove('active'));
            document.querySelector('.mypage-tab[data-tab="allchallenge"]').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
            document.getElementById('tab-allchallenge').classList.remove('hidden');
            // 팀도전 서브탭 클릭
            const teamTab = document.querySelector('[data-ctab="team"]');
            if (teamTab) teamTab.click();
        }

        function selectTeamMission(btn) {
            // 기존 선택 해제
            document.querySelectorAll('.tc-next-btn').forEach(b => {
                b.classList.remove('selected');
                b.textContent = '도전 예약하기';
            });
            // 선택 표시
            btn.classList.add('selected');
            btn.textContent = '✅ 예약 완료!';
        }

        // === 갤러리 탭 전환 ===
        function switchGalleryTab(tab) {
            document.querySelectorAll('.gallery-subtab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.gallery-subtab[data-gtab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.gallery-content').forEach(c => c.classList.add('hidden'));
            document.getElementById('gtab-' + tab).classList.remove('hidden');

            if (tab === 'my') renderMyGallery();
            if (tab === 'friends') renderFriendsGallery();
            if (tab === 'following') renderFollowingTab();
        }

        // === 필터 ===
        function filterGallery(filter) {
            galleryFilter = filter;
            document.querySelectorAll('.gallery-filter').forEach(f => f.classList.remove('active'));
            document.querySelector(`.gallery-filter[data-filter="${filter}"]`).classList.add('active');
            renderMyGallery();
        }

        // === 정렬 ===
        function sortGallery(sort) {
            gallerySort = sort;
            document.querySelectorAll('#gtab-my .gallery-sort').forEach(s => s.classList.remove('active'));
            document.querySelector(`#gtab-my .gallery-sort[data-sort="${sort}"]`).classList.add('active');
            renderMyGallery();
        }

        // === 내 작품 그리드 렌더링 ===
        function renderMyGallery() {
            const grid = document.getElementById('my-gallery-grid');

            // 실제 감상문 데이터 로드
            loadReviews();

            // 감상문 데이터를 갤러리 형식으로 변환
            const reviewWorks = allReviews.map(r => ({
                id: r.id,
                type: 'review',
                title: r.bookTitle,
                likes: r.likes || Math.floor(Math.random() * 30),
                date: r.createdAt.replace(/\./g, '').replace(/\s/g, ''),
                bg: 'bg-gradient-to-br from-green-200 to-emerald-300',
                emoji: REVIEW_TYPES[r.type]?.icon || '✏️',
                typeLabel: '감상문',
                typeColor: 'text-green-600',
                isRealReview: true,
                reviewId: r.id,
                reviewData: r // 원본 리뷰 데이터 포함
            }));

            // 더미 데이터와 실제 감상문 합치기
            let works = [...myWorks, ...reviewWorks];

            // 필터링
            if (galleryFilter !== 'all') {
                works = works.filter(w => w.type === galleryFilter);
            }

            // 정렬
            if (gallerySort === 'likes') {
                works.sort((a, b) => b.likes - a.likes);
            } else {
                works.sort((a, b) => {
                    const dateA = parseInt(a.date) || 0;
                    const dateB = parseInt(b.date) || 0;
                    return dateB - dateA;
                });
            }

            // 총 개수 업데이트
            const countEl = document.querySelector('#gtab-my .text-gray-600');
            if (countEl) {
                countEl.textContent = works.length;
            }

            grid.innerHTML = works.map(w => {
                // 실제 감상문인 경우 review-card 스타일로 렌더링
                if (w.isRealReview && w.reviewData) {
                    const review = w.reviewData;
                    const typeInfo = REVIEW_TYPES[review.type] || {};
                    const colorClass = typeInfo.class || '';

                    return `
                        <div class="review-card" onclick="viewReview('${w.reviewId}')">
                            <div class="review-cover">
                                ${review.drawingData
                                    ? `<img src="${review.drawingData}" alt="${review.bookTitle}">`
                                    : `<div style="width:100%;height:100%;background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);display:flex;align-items:center;justify-content:center;"><span style="font-size:60px;">${typeInfo.icon}</span></div>`
                                }
                                <div class="review-type-badge ${colorClass}">
                                    ${typeInfo.icon} ${typeInfo.label}
                                </div>
                            </div>
                            <div class="review-info">
                                <h4>${review.bookTitle}</h4>
                                <div class="review-desc">
                                    <i class="fa-solid fa-heart" style="color:#f87171;"></i> ${w.likes} · ${review.createdAt}
                                </div>
                            </div>
                        </div>
                    `;
                }

                // 더미 작품은 기존 gallery-item 스타일로
                return `
                    <div class="gallery-item" data-type="${w.type}" onclick="openWork(${w.id})">
                        <div class="gallery-item-bg ${w.bg}">${w.emoji}</div>
                        <div class="gallery-item-type ${w.typeColor}">${w.typeLabel}</div>
                        <div class="gallery-item-overlay">
                            <div class="gallery-item-likes"><i class="fa-solid fa-heart"></i> ${w.likes}</div>
                            <div class="gallery-item-title">${w.title}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // === 친구 작품 피드 렌더링 ===
        function renderFriendsGallery() {
            const feed = document.getElementById('friends-gallery-feed');
            feed.innerHTML = friendsWorks.map(w => {
                const highlightClass = w.following ? 'highlight' : '';
                const likedClass = w.liked ? 'liked' : '';
                const heartIcon = w.liked ? 'fa-solid fa-heart' : 'fa-regular fa-heart';

                return `
                <div class="friend-work-card ${highlightClass}" onclick="openWork(${w.id})">
                    <div class="friend-header">
                        <div class="friend-info">
                            <div class="friend-avatar bg-gradient-to-br ${w.avatarBg}">${w.avatar}</div>
                            <div class="friend-details">
                                <div class="friend-name">${w.name}</div>
                                <div class="friend-time">${w.time}</div>
                            </div>
                        </div>
                        ${w.following ? '<span class="following-badge">❤️</span>' : ''}
                    </div>
                    <div class="work-cover">
                        <div class="${w.bg}" style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;">
                            <span style="font-size:80px;">${w.emoji}</span>
                        </div>
                    </div>
                    <div class="work-footer">
                        <button class="like-btn ${likedClass}" onclick="event.stopPropagation(); toggleLike(this, ${w.id})">
                            <i class="${heartIcon}"></i>
                            <span>${w.likes}</span>
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // === 좋아요 토글 ===
        function toggleLike(btn, workId) {
            const work = friendsWorks.find(w => w.id === workId);
            if (!work) return;

            work.liked = !work.liked;
            work.likes = work.liked ? work.likes + 1 : work.likes - 1;

            // UI 업데이트
            const icon = btn.querySelector('i');
            const count = btn.querySelector('span');

            if (work.liked) {
                btn.classList.add('liked');
                icon.className = 'fa-solid fa-heart';
            } else {
                btn.classList.remove('liked');
                icon.className = 'fa-regular fa-heart';
            }

            count.textContent = work.likes;
        }

        // === 관심친구 탭 렌더링 ===
        function renderFollowingTab() {
            // 내가 관심+한 친구
            const followingList = document.getElementById('following-list');
            followingList.innerHTML = followingFriends.map(f => `
                <div class="friend-card">
                    <div class="flex items-center gap-3">
                        <div class="friend-avatar bg-gradient-to-br ${f.avatarBg}">${f.avatar}</div>
                        <div>
                            <p class="text-sm font-bold text-gray-800">${f.name}</p>
                            <p class="text-[10px] text-gray-400">${f.class} · 작품 ${f.works}개</p>
                            <div class="flex gap-1 mt-1">
                                ${f.tags.map(t => `<span class="text-[9px] bg-gray-50 text-gray-500 px-1.5 py-0.5 rounded">${t}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <button class="follow-btn following" onclick="toggleFollowBtn(this)"><i class="fa-solid fa-check"></i> 관심친구</button>
                        <p class="text-[9px] text-gray-300 mt-1">${f.lastActive} 활동</p>
                    </div>
                </div>
            `).join('');

            // 나를 관심+한 친구
            const followersList = document.getElementById('followers-list');
            followersList.innerHTML = followerFriends.map(f => {
                const btnClass = f.following ? 'following' : '';
                const btnText = f.following ? '<i class="fa-solid fa-check"></i> 관심친구' : '<i class="fa-solid fa-plus"></i> 관심+';
                return `
                <div class="friend-card">
                    <div class="flex items-center gap-3">
                        <div class="friend-avatar bg-gradient-to-br ${f.avatarBg}">${f.avatar}</div>
                        <div>
                            <p class="text-sm font-bold text-gray-800">${f.name}</p>
                            <p class="text-[10px] text-gray-400">${f.class} · 작품 ${f.works}개</p>
                        </div>
                    </div>
                    <button class="follow-btn ${btnClass}" onclick="toggleFollowBtn(this)">${btnText}</button>
                </div>
                `;
            }).join('');
        }

        // === 팔로우 토글 ===
        function toggleFollowBtn(btn) {
            if (btn.classList.contains('following')) {
                btn.classList.remove('following');
                btn.innerHTML = '<i class="fa-solid fa-plus"></i> 관심+';
            } else {
                btn.classList.add('following');
                btn.innerHTML = '<i class="fa-solid fa-check"></i> 관심친구';
            }
        }

        // === 작품 상세보기 ===
        let currentViewingWork = null;

        function openWork(id) {
            const work = friendsWorks.find(w => w.id === id);
            if (!work) return;

            currentViewingWork = work;

            // 모달 요소 가져오기
            const modal = document.getElementById('friend-work-modal');
            const avatar = document.getElementById('friend-work-avatar');
            const name = document.getElementById('friend-work-name');
            const time = document.getElementById('friend-work-time');
            const image = document.getElementById('friend-work-image');
            const title = document.getElementById('friend-work-title');
            const type = document.getElementById('friend-work-type');
            const desc = document.getElementById('friend-work-desc');
            const likes = document.getElementById('friend-work-likes');
            const likeBtn = document.getElementById('friend-work-like-btn');

            // 데이터 채우기
            avatar.className = `w-12 h-12 rounded-full bg-gradient-to-br ${work.avatarBg} flex items-center justify-center text-2xl`;
            avatar.textContent = work.avatar;
            name.textContent = work.name;
            time.textContent = `${work.class} · ${work.time}`;

            image.className = `w-full aspect-video ${work.bg} flex items-center justify-center`;
            image.innerHTML = `<span style="font-size:120px;">${work.emoji}</span>`;

            title.textContent = work.title;
            type.textContent = work.typeLabel;
            desc.textContent = work.desc;
            likes.textContent = work.likes;

            // 좋아요 상태 업데이트
            if (work.liked) {
                likeBtn.classList.add('text-red-500');
                likeBtn.querySelector('i').className = 'fa-solid fa-heart text-lg';
            } else {
                likeBtn.classList.remove('text-red-500');
                likeBtn.querySelector('i').className = 'fa-regular fa-heart text-lg';
            }

            // 모달 표시
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeFriendWorkModal() {
            const modal = document.getElementById('friend-work-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            currentViewingWork = null;
        }

        function toggleWorkLike() {
            if (!currentViewingWork) return;

            currentViewingWork.liked = !currentViewingWork.liked;
            currentViewingWork.likes = currentViewingWork.liked ? currentViewingWork.likes + 1 : currentViewingWork.likes - 1;

            // UI 업데이트
            const likes = document.getElementById('friend-work-likes');
            const likeBtn = document.getElementById('friend-work-like-btn');
            const icon = likeBtn.querySelector('i');

            likes.textContent = currentViewingWork.likes;

            if (currentViewingWork.liked) {
                likeBtn.classList.add('text-red-500');
                icon.className = 'fa-solid fa-heart text-lg';
            } else {
                likeBtn.classList.remove('text-red-500');
                icon.className = 'fa-regular fa-heart text-lg';
            }

            // 갤러리도 업데이트
            renderFriendsGallery();
        }

        // === 감상문 관련 함수 ===
        function loadReviews() {
            try {
                allReviews = JSON.parse(localStorage.getItem(REVIEW_STORAGE_KEY) || '[]');
                // 좋아요 정보가 없는 경우 랜덤 추가 (테스트용)
                allReviews = allReviews.map(r => ({
                    ...r,
                    likes: r.likes || Math.floor(Math.random() * 30)
                }));
            } catch {
                allReviews = [];
            }
        }

        // === 내 감상문 상세보기 ===
        let currentViewingReview = null;

        function viewReview(id) {
            const review = allReviews.find(r => r.id === id);
            if (!review) return;

            currentViewingReview = review;

            // 모달 요소 가져오기
            const modal = document.getElementById('my-review-modal');
            const time = document.getElementById('my-review-time');
            const image = document.getElementById('my-review-image');
            const bookTitle = document.getElementById('my-review-book-title');
            const typeBadge = document.getElementById('my-review-type-badge');
            const likes = document.getElementById('my-review-likes');

            // 데이터 채우기
            time.textContent = review.createdAt;

            // 그림 표시
            const typeInfo = REVIEW_TYPES[review.type] || {};
            if (review.drawingData) {
                image.innerHTML = `<img src="${review.drawingData}" alt="${review.bookTitle}" style="max-width:100%;max-height:500px;object-fit:contain;">`;
            } else {
                image.innerHTML = `<span style="font-size:120px;">${typeInfo.icon}</span>`;
            }

            bookTitle.textContent = review.bookTitle;

            // 타입 뱃지
            const colorClass = typeInfo.class || '';
            const badgeColors = {
                purple: 'bg-purple-100 text-purple-600',
                pink: 'bg-pink-100 text-pink-600',
                amber: 'bg-amber-100 text-amber-600',
                '': 'bg-orange-100 text-orange-600'
            };
            typeBadge.className = `px-3 py-1 rounded-full text-xs font-bold ${badgeColors[colorClass]}`;
            typeBadge.textContent = `${typeInfo.icon} ${typeInfo.label}`;

            likes.textContent = review.likes || 0;

            // 모달 표시
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeMyReviewModal() {
            const modal = document.getElementById('my-review-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            currentViewingReview = null;
        }

        function editMyReview() {
            if (!currentViewingReview) return;

            sessionStorage.setItem('reviewId', currentViewingReview.id);
            sessionStorage.setItem('referrer', 'mypage.html');
            location.href = 'review-writer.html';
        }

        function deleteMyReview() {
            if (!currentViewingReview) return;

            if (!confirm(`"${currentViewingReview.bookTitle}" 감상문을 정말 삭제하시겠습니까?`)) {
                return;
            }

            // localStorage에서 삭제
            const updated = allReviews.filter(r => r.id !== currentViewingReview.id);
            localStorage.setItem(REVIEW_STORAGE_KEY, JSON.stringify(updated));
            allReviews = updated;

            // 모달 닫기
            closeMyReviewModal();

            // 갤러리 새로고침
            renderMyGallery();

            // 알림
            alert('감상문이 삭제되었습니다.');
        }

        // === 활동 카드 슬라이더 ===
        let currentSlideIndex = 0;
        let sliderInterval = null;
        const SLIDE_INTERVAL = 3000; // 3초

        function initActivitySlider() {
            const track = document.getElementById('activitySliderTrack');
            const dots = document.querySelectorAll('.activity-slider-dots .dot');

            if (!track || dots.length === 0) return;

            // Dot 클릭 이벤트
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    goToSlide(index);
                    resetSliderInterval();
                });
            });

            // 자동 슬라이드 시작
            startAutoSlide();
        }

        function goToSlide(index) {
            const track = document.getElementById('activitySliderTrack');
            const dots = document.querySelectorAll('.activity-slider-dots .dot');
            const totalSlides = dots.length;

            currentSlideIndex = index;

            // 슬라이더 이동
            const offset = -100 * currentSlideIndex;
            track.style.transform = `translateX(${offset}%)`;

            // Dot 업데이트
            dots.forEach(dot => dot.classList.remove('active'));
            dots[currentSlideIndex].classList.add('active');
        }

        function nextSlide() {
            const dots = document.querySelectorAll('.activity-slider-dots .dot');
            const totalSlides = dots.length;
            const nextIndex = (currentSlideIndex + 1) % totalSlides;
            goToSlide(nextIndex);
        }

        function startAutoSlide() {
            sliderInterval = setInterval(() => {
                nextSlide();
            }, SLIDE_INTERVAL);
        }

        function resetSliderInterval() {
            if (sliderInterval) {
                clearInterval(sliderInterval);
            }
            startAutoSlide();
        }

        // === Init ===
        document.addEventListener('DOMContentLoaded', () => {
            loadSidebar('mypage');
            loadLogoutModal();
            renderCalendar();
            renderBookshelf(); // 초기 책장 렌더링
            renderMyGallery(); // 갤러리 초기화
            renderFriendsGallery();
            renderFollowingTab();
            loadReviews(); // 감상문 데이터 로드
            initActivitySlider(); // 슬라이더 초기화
        });
    </script>

    <!-- 독서로 키재기 마일스톤 팝업 -->
    <div id="milestone-modal" class="milestone-modal">
        <div class="milestone-modal-content">
            <!-- 닫기 버튼 -->
            <button class="milestone-close-btn" onclick="closeMilestoneModal()">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <!-- 타이틀 -->
            <h2 class="milestone-title">어디까지 클 수 있을까? 📚</h2>
            <p class="milestone-subtitle">책을 읽을수록 점점 더 높이 자라나요!</p>

            <!-- 캐러셀 영역 -->
            <div class="milestone-carousel">
                <!-- Stage cards will be generated by JavaScript -->
            </div>

            <!-- 네비게이션 -->
            <div class="milestone-nav">
                <button class="milestone-nav-btn milestone-prev" onclick="prevMilestone()">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
                <div class="milestone-indicators">
                    <!-- Dots will be generated by JavaScript -->
                </div>
                <button class="milestone-nav-btn milestone-next" onclick="nextMilestone()">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

<!-- Proto Navigation (공통 Dev Tool) -->
<link rel="stylesheet" href="../css/proto-nav.css">
<script src="../js/proto-nav.js"></script>
</body>
</html>
